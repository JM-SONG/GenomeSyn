<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#FEEDBACK">FEEDBACK</a>
    <ul>
      <li><a href="#Mailing-Lists">Mailing Lists</a></li>
      <li><a href="#Support">Support</a></li>
      <li><a href="#Reporting-Bugs">Reporting Bugs</a></li>
    </ul>
  </li>
  <li><a href="#AUTHOR---Jason-Stajich">AUTHOR - Jason Stajich</a></li>
  <li><a href="#CONTRIBUTORS">CONTRIBUTORS</a></li>
  <li><a href="#APPENDIX">APPENDIX</a>
    <ul>
      <li><a href="#new">new</a></li>
      <li><a href="#assess_bootstrap">assess_bootstrap</a></li>
      <li><a href="#cherries">cherries</a></li>
      <li><a href="#Tree-Trait-statistics">Tree-Trait statistics</a></li>
      <li><a href="#fitch">fitch</a></li>
      <li><a href="#ps">ps</a></li>
      <li><a href="#fitch_up">fitch_up</a></li>
      <li><a href="#fitch_down">fitch_down</a></li>
      <li><a href="#persistence">persistence</a></li>
      <li><a href="#count_subclusters">count_subclusters</a></li>
      <li><a href="#count_leaves">count_leaves</a></li>
      <li><a href="#phylotype_length">phylotype_length</a></li>
      <li><a href="#sum_of_leaf_distances">sum_of_leaf_distances</a></li>
      <li><a href="#genetic_diversity">genetic_diversity</a></li>
      <li><a href="#statratio">statratio</a></li>
      <li><a href="#ai">ai</a></li>
      <li><a href="#mc">mc</a></li>
    </ul>
  </li>
  <li><a href="#POD-ERRORS">POD ERRORS</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Bio::Tree::Statistics - Calculate certain statistics for a Tree</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Bio::Tree::Statistics</span><span class="operator">;</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This should be where Tree statistics are calculated. It was previously where statistics from a Coalescent simulation.</p>

<p>It now contains several methods for calculating <a href="#Tree-Trait-statistics">&quot;Tree-Trait statistics&quot;</a>.</p>

<h1 id="FEEDBACK">FEEDBACK</h1>

<h2 id="Mailing-Lists">Mailing Lists</h2>

<p>User feedback is an integral part of the evolution of this and other Bioperl modules. Send your comments and suggestions preferably to the Bioperl mailing list. Your participation is much appreciated.</p>

<pre><code><code>  bioperl-l@bioperl.org                  - General discussion
  http://bioperl.org/wiki/Mailing_lists  - About the mailing lists</code></code></pre>

<h2 id="Support">Support</h2>

<p>Please direct usage questions or support issues to the mailing list:</p>

<p><i>bioperl-l@bioperl.org</i></p>

<p>rather than to the module maintainer directly. Many experienced and reponsive experts will be able look at the problem and quickly address it. Please include a thorough description of the problem with code and data examples if at all possible.</p>

<h2 id="Reporting-Bugs">Reporting Bugs</h2>

<p>Report bugs to the Bioperl bug tracking system to help us keep track of the bugs and their resolution. Bug reports can be submitted via the web:</p>

<pre><code><code>  https://redmine.open-bio.org/projects/bioperl/</code></code></pre>

<h1 id="AUTHOR---Jason-Stajich">AUTHOR - Jason Stajich</h1>

<p>Email jason AT bioperl.org</p>

<h1 id="CONTRIBUTORS">CONTRIBUTORS</h1>

<p>Heikki Lehvaslaiho, heikki at bioperl dot org</p>

<h1 id="APPENDIX">APPENDIX</h1>

<p>The rest of the documentation details each of the object methods. Internal methods are usually preceded with a _</p>

<h2 id="new">new</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">new</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$obj</span> <span class="operator">=</span> <span class="variable">Bio::Tree::Statistics</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">();</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Builds</span> <span class="variable">a</span> <span class="variable">new</span> <span class="variable">Bio::Tree::Statistics</span> <span class="variable">object</span> 
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">Bio::Tree::Statistics</span>
 <span class="variable">Args</span>    <span class="operator">:</span>
</code></code></pre>

<h2 id="assess_bootstrap">assess_bootstrap</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">assess_bootstrap</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$tree_with_bs</span> <span class="operator">=</span> <span class="variable">$stats</span><span class="operator">-&gt;</span><span class="variable">assess_bootstrap</span><span class="operator">(\</span><span class="variable">@bs_trees</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">the</span> <span class="variable">bootstrap</span> <span class="keyword">for</span> <span class="variable">internal</span> <span class="variable">nodes</span> <span class="variable">based</span> <span class="variable">on</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">Bio::Tree::TreeI</span><span class="operator">&gt;</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Arrayref</span> <span class="variable">of</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">Bio::Tree::TreeI</span><span class="operator">&gt;</span><span class="keyword">s</span>
</code></code></pre>

<h2 id="cherries">cherries</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">cherries</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Count</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">paired</span> <span class="variable">leaf</span> <span class="variable">nodes</span>
               <span class="variable">in</span> <span class="variable">a</span> <span class="variable">binary</span> <span class="variable">tree</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">integer</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> 
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Commonly used statistics assume a binary tree, but this methods returns a value even for trees with polytomies.</p>

<h2 id="Tree-Trait-statistics">Tree-Trait statistics</h2>

<p>The following methods produce desciptors of trait distribution among leaf nodes within the trees. They require that a trait has been set for each leaf node. The tag methods of Bio::Tree::Node are used to store them as key/value pairs. In this way, one tree can store more than one trait.</p>

<p>Trees have method add_traits() to set trait values from a file.</p>

<h2 id="fitch">fitch</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">fitch</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">Parsimony</span> <span class="variable">Score</span> <span class="operator">(</span><span class="variable">PS</span><span class="operator">)</span> <span class="keyword">and</span> <span class="variable">internal</span> <span class="variable">trait</span>
               <span class="keyword">values</span> <span class="variable">using</span> <span class="variable">the</span> <span class="variable">Fitch</span> <span class="number">1971</span> <span class="variable">parsimony</span> <span class="variable">algorithm</span> <span class="keyword">for</span>
               <span class="variable">the</span> <span class="variable">subtree</span> <span class="variable">a</span> <span class="keyword">defined</span> <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span> <span class="variable">node</span><span class="operator">.</span>
               <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">true</span> <span class="variable">on</span> <span class="variable">success</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">leaf</span> <span class="variable">nodes</span> <span class="variable">have</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">trait</span> <span class="variable">name</span> <span class="variable">string</span>
               <span class="number">3.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Runs first <a>fitch_up</a> that calculats parsimony scores and then <a>fitch_down</a> that should resolve most of the trait/character state ambiguities.</p>

<p>Fitch, W.M., 1971. Toward de&#xFB01;ning the course of evolution: minimal change for a speci&#xFB01;c tree topology. Syst. Zool. 20, 406-416.</p>

<p>You can access calculated parsimony values using:</p>

<pre><code><code>  <span class="variable">$score</span> <span class="operator">=</span> <span class="variable">$node</span><span class="operator">-&gt;-&gt;</span><span class="variable">get_tag_values</span><span class="operator">(</span><span class="string">'ps_score'</span><span class="operator">);</span>
</code></code></pre>

<p>and the trait value with:</p>

<pre><code><code>  <span class="variable">$traitvalue</span> <span class="operator">=</span> <span class="variable">$node</span><span class="operator">-&gt;-&gt;</span><span class="variable">get_tag_values</span><span class="operator">(</span><span class="string">'ps_trait'</span><span class="operator">);</span> <span class="comment"># only the first</span>
  <span class="variable">@traitvalues</span> <span class="operator">=</span> <span class="variable">$node</span><span class="operator">-&gt;-&gt;</span><span class="variable">get_tag_values</span><span class="operator">(</span><span class="string">'ps_trait'</span><span class="operator">);</span>
</code></code></pre>

<p>Note that there can be more that one trait value, especially for the root node.</p>

<h2 id="ps">ps</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">ps</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">Parsimony</span> <span class="variable">Score</span> <span class="operator">(</span><span class="variable">PS</span><span class="operator">)</span> <span class="variable">from</span> <span class="variable">Fitch</span> <span class="number">1971</span>
               <span class="variable">parsimony</span> <span class="variable">algorithm</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">subtree</span> <span class="variable">a</span> <span class="keyword">defined</span>
               <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span> <span class="variable">node</span><span class="operator">.</span>
               <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">integer</span><span class="operator">,</span> <span class="number">1</span><span class="operator">&lt;</span> <span class="variable">PS</span> <span class="operator">&lt;</span> <span class="variable">n</span><span class="operator">,</span> <span class="variable">where</span> <span class="variable">n</span> <span class="variable">is</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">branches</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">leaf</span> <span class="variable">nodes</span> <span class="variable">have</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">trait</span> <span class="variable">name</span> <span class="variable">string</span>
               <span class="number">3.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>This is the first half of the Fitch algorithm that is enough for calculating the resolved parsimony values. The trait/chararacter states are commonly left in ambiguos state. To resolve them, run <a>fitch_down</a>.</p>

<h2 id="fitch_up">fitch_up</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">fitch_up</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">Parsimony</span> <span class="variable">Score</span> <span class="operator">(</span><span class="variable">PS</span><span class="operator">)</span> <span class="variable">from</span> <span class="variable">the</span> <span class="variable">Fitch</span> <span class="number">1971</span>
               <span class="variable">parsimony</span> <span class="variable">algorithm</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">subtree</span> <span class="variable">a</span> <span class="keyword">defined</span>
               <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span> <span class="variable">node</span><span class="operator">.</span>
               <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">integer</span><span class="operator">,</span> <span class="number">1</span><span class="operator">&lt;</span> <span class="variable">PS</span> <span class="operator">&lt;</span> <span class="variable">n</span><span class="operator">,</span> <span class="variable">where</span> <span class="variable">n</span> <span class="variable">is</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">branches</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">leaf</span> <span class="variable">nodes</span> <span class="variable">have</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">trait</span> <span class="variable">name</span> <span class="variable">string</span>
               <span class="number">3.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>This is a more generic name for <a>ps</a> and indicates that it performs the first bottom-up tree traversal that calculates the parsimony score but usually leaves trait/character states ambiguous. If you are interested in internal trait states, running <a>fitch_down</a> should resolve most of the ambiguities.</p>

<h2 id="fitch_down">fitch_down</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">fitch_down</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Runs</span> <span class="variable">the</span> <span class="variable">second</span> <span class="variable">pass</span> <span class="variable">from</span> <span class="variable">Fitch</span> <span class="number">1971</span>
               <span class="variable">parsimony</span> <span class="variable">algorithm</span> <span class="variable">to</span> <span class="variable">resolve</span> <span class="variable">ambiguous</span>
               <span class="variable">trait</span> <span class="variable">states</span> <span class="variable">left</span> <span class="variable">by</span> <span class="variable">first</span> <span class="variable">pass</span><span class="operator">.</span>
               <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span> <span class="variable">node</span><span class="operator">.</span>
               <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">true</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">dies</span> <span class="keyword">unless</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="variable">is</span> <span class="keyword">defined</span> <span class="variable">in</span> <span class="variable">all</span> <span class="variable">nodes</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Before running this method you should have ran <a>fitch_up</a> (alias to <a>ps</a> ). Note that it is not guarantied that all states are completely resolved.</p>

<h2 id="persistence">persistence</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">persistence</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">the</span> <span class="variable">persistence</span>
               <span class="keyword">for</span> <span class="variable">node</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">subtree</span> <span class="keyword">defined</span> <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span>
               <span class="variable">node</span><span class="operator">.</span>  <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="keyword">int</span><span class="operator">,</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">generations</span> <span class="variable">trait</span> <span class="variable">value</span> <span class="variable">has</span> <span class="variable">to</span> <span class="variable">remain</span> <span class="variable">same</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">all</span> <span class="variable">the</span>  <span class="variable">nodes</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Persistence is a measure of the stability the trait value has in a tree. It expresses the number of generations the trait value remains the same. All the decendants of the root in the same generation have to share the same value.</p>

<p>Depends on Fitch&#39;s parsimony score (PS).</p>

<h2 id="count_subclusters">count_subclusters</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">count_clusters</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sub</span><span class="operator">-</span><span class="variable">clusters</span>
               <span class="variable">in</span> <span class="variable">the</span> <span class="variable">subtree</span> <span class="keyword">defined</span> <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span>
               <span class="variable">node</span><span class="operator">.</span>  <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="keyword">int</span><span class="operator">,</span> <span class="variable">count</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">all</span> <span class="variable">the</span>  <span class="variable">nodes</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Depends on Fitch&#39;s parsimony score (PS).</p>

<h2 id="count_leaves">count_leaves</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">count_leaves</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">leaves</span> <span class="variable">with</span> <span class="variable">same</span> <span class="variable">trait</span>
               <span class="variable">value</span> <span class="variable">as</span> <span class="variable">root</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">subtree</span> <span class="keyword">defined</span> <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span>
               <span class="variable">node</span><span class="operator">.</span>  <span class="variable">Requires</span> <span class="variable">an</span> <span class="variable">unbroken</span> <span class="variable">line</span> <span class="variable">of</span> <span class="variable">identical</span> <span class="variable">trait</span> <span class="keyword">values</span><span class="operator">.</span>
               <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="keyword">int</span><span class="operator">,</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">leaves</span> <span class="variable">with</span> <span class="variable">this</span> <span class="variable">trait</span> <span class="variable">value</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">all</span> <span class="variable">the</span>  <span class="variable">nodes</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Depends on Fitch&#39;s parsimony score (PS).</p>

<h2 id="phylotype_length">phylotype_length</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">phylotype_length</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Sums</span> <span class="variable">up</span> <span class="variable">the</span> <span class="variable">branch</span> <span class="variable">lengths</span> <span class="variable">within</span> <span class="variable">phylotype</span>
               <span class="variable">exluding</span> <span class="variable">the</span> <span class="variable">subclusters</span> <span class="variable">where</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">values</span>
               <span class="variable">are</span> <span class="variable">different</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">float</span><span class="operator">,</span> <span class="keyword">length</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">all</span> <span class="variable">the</span>  <span class="variable">nodes</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Depends on Fitch&#39;s parsimony score (PS).</p>

<h2 id="sum_of_leaf_distances">sum_of_leaf_distances</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">sum_of_leaf_distances</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Sums</span> <span class="variable">up</span> <span class="variable">the</span> <span class="variable">branch</span> <span class="variable">lengths</span> <span class="variable">from</span> <span class="variable">root</span> <span class="variable">to</span> <span class="variable">leaf</span>
               <span class="variable">exluding</span> <span class="variable">the</span> <span class="variable">subclusters</span> <span class="variable">where</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">values</span>
               <span class="variable">are</span> <span class="variable">different</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">float</span><span class="operator">,</span> <span class="keyword">length</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">all</span> <span class="variable">the</span>  <span class="variable">nodes</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Depends on Fitch&#39;s parsimony score (PS).</p>

<h2 id="genetic_diversity">genetic_diversity</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">genetic_diversity</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Diversity</span> <span class="variable">is</span> <span class="variable">the</span> <span class="variable">sum</span> <span class="variable">of</span> <span class="variable">root</span> <span class="variable">to</span> <span class="variable">leaf</span> <span class="variable">distances</span>
               <span class="variable">within</span> <span class="variable">the</span> <span class="variable">phylotype</span> <span class="variable">normalised</span> <span class="variable">by</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">leaf</span>
               <span class="variable">nodes</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">float</span><span class="operator">,</span> <span class="variable">value</span> <span class="variable">of</span> <span class="variable">genetic</span> <span class="variable">diversity</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">all</span> <span class="variable">the</span>  <span class="variable">nodes</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Depends on Fitch&#39;s parsimony score (PS).</p>

<h2 id="statratio">statratio</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">statratio</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Ratio</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">stem</span> <span class="keyword">length</span> <span class="keyword">and</span> <span class="variable">the</span> <span class="variable">genetic</span> <span class="variable">diversity</span> <span class="variable">of</span> <span class="variable">the</span>
               <span class="variable">phylotype</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">genetic_diversity</span><span class="operator">&gt;</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">float</span><span class="operator">,</span> <span class="variable">separation</span> <span class="variable">score</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">all</span> <span class="variable">the</span>  <span class="variable">nodes</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>TStatratio gives a measure of separation and variability within the phylotype. Larger values identify more rapidly evolving and recent phylotypes.</p>

<p>Depends on Fitch&#39;s parsimony score (PS).</p>

<h2 id="ai">ai</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">ai</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">the</span> <span class="variable">Association</span> <span class="variable">Index</span> <span class="operator">(</span><span class="variable">AI</span><span class="operator">)</span> <span class="variable">of</span> <span class="variable">Whang</span> <span class="variable">et</span>
               <span class="variable">al</span><span class="operator">.</span> <span class="number">2001</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">subtree</span> <span class="keyword">defined</span> <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span>
               <span class="variable">node</span><span class="operator">.</span>  <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">real</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">leaf</span> <span class="variable">nodes</span> <span class="variable">have</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">trait</span> <span class="variable">name</span> <span class="variable">string</span>
               <span class="number">3.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
  
  <span class="variable">Association</span> <span class="keyword">index</span> <span class="operator">(</span><span class="variable">AI</span><span class="operator">)</span> <span class="variable">gives</span> <span class="variable">a</span> <span class="variable">more</span> <span class="variable">fine</span> <span class="variable">grained</span> <span class="variable">results</span> <span class="variable">than</span> <span class="variable">PS</span> <span class="variable">since</span>
  <span class="variable">the</span> <span class="variable">result</span> <span class="variable">is</span> <span class="variable">a</span> <span class="variable">real</span> <span class="variable">number</span><span class="operator">.</span> <span class="operator">~</span><span class="number">0</span> <span class="variable">E</span><span class="operator">&lt;</span><span class="keyword">lt</span><span class="operator">&gt;=</span> <span class="variable">AI</span><span class="operator">.</span>
  
  <span class="variable">Wang</span><span class="operator">,</span> <span class="variable">T</span><span class="operator">.</span><span class="variable">H</span><span class="operator">.,</span> <span class="variable">Donaldson</span><span class="operator">,</span> <span class="variable">Y</span><span class="operator">.</span><span class="variable">K</span><span class="operator">.,</span> <span class="variable">Brettle</span><span class="operator">,</span> <span class="variable">R</span><span class="operator">.</span><span class="variable">P</span><span class="operator">.,</span> <span class="variable">Bell</span><span class="operator">,</span> <span class="variable">J</span><span class="operator">.</span><span class="variable">E</span><span class="operator">.,</span> <span class="variable">Simmonds</span><span class="operator">,</span> <span class="variable">P</span><span class="operator">.,</span>
  <span class="number">2001.</span>  <span class="variable">Identi</span>ﬁ<span class="variable">cation</span> <span class="variable">of</span> <span class="variable">shared</span> <span class="variable">populations</span> <span class="variable">of</span> <span class="variable">human</span> <span class="variable">immunode</span>ﬁ<span class="variable">ciency</span>
  <span class="variable">Virus</span> <span class="variable">Type</span> <span class="number">1</span> <span class="variable">infecting</span> <span class="variable">microglia</span> <span class="keyword">and</span> <span class="variable">tissue</span> <span class="variable">macrophages</span> <span class="variable">outside</span> <span class="variable">the</span>
  <span class="variable">central</span> <span class="variable">nervous</span> <span class="keyword">system</span><span class="operator">.</span> <span class="variable">J</span><span class="operator">.</span> <span class="variable">Virol</span><span class="operator">.</span> <span class="number">75</span> <span class="operator">(</span><span class="number">23</span><span class="operator">),</span> <span class="number">11686</span><span class="operator">-</span><span class="number">11699.</span>
</code></code></pre>

<h2 id="mc">mc</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">mc</span><span class="operator">(</span><span class="variable">$tree</span><span class="operator">,</span> <span class="variable">$key</span><span class="operator">,</span> <span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Calculates</span> <span class="variable">the</span> <span class="variable">Monophyletic</span> <span class="variable">Clade</span> <span class="operator">(</span><span class="variable">MC</span><span class="operator">)</span> <span class="variable">size</span> <span class="variable">statistics</span>
               <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">subtree</span> <span class="variable">a</span> <span class="keyword">defined</span> <span class="variable">by</span> <span class="variable">the</span> <span class="operator">(</span><span class="variable">internal</span><span class="operator">)</span> <span class="variable">node</span><span class="operator">.</span>
               <span class="variable">Node</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">root</span><span class="operator">;</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">hashref</span> <span class="variable">with</span> <span class="variable">trait</span> <span class="keyword">values</span> <span class="variable">as</span> <span class="keyword">keys</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="variable">leaf</span> <span class="variable">nodes</span> <span class="variable">have</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">the</span> <span class="variable">trait</span> <span class="keyword">defined</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="number">1.</span> <span class="variable">Bio::Tree::TreeI</span> <span class="variable">object</span>
               <span class="number">2.</span> <span class="variable">trait</span> <span class="variable">name</span> <span class="variable">string</span>
               <span class="number">3.</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">object</span> <span class="variable">within</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">optional</span>
  
  <span class="variable">Monophyletic</span> <span class="variable">Clade</span> <span class="operator">(</span><span class="variable">MC</span><span class="operator">)</span> <span class="variable">size</span> <span class="variable">statistics</span> <span class="variable">by</span> <span class="variable">Salemi</span> <span class="variable">at</span> <span class="variable">al</span> <span class="number">2005.</span> <span class="variable">It</span> <span class="variable">is</span>
  <span class="variable">calculated</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="variable">trait</span> <span class="variable">value</span><span class="operator">.</span> <span class="number">1</span> <span class="variable">E</span><span class="operator">&lt;</span><span class="keyword">lt</span><span class="operator">&gt;=</span> <span class="variable">MC</span> <span class="variable">E</span><span class="operator">&lt;</span><span class="keyword">lt</span><span class="operator">&gt;=</span> <span class="variable">nx</span><span class="operator">,</span> <span class="variable">where</span> <span class="variable">nx</span> <span class="variable">is</span> <span class="variable">the</span>
  <span class="variable">number</span> <span class="variable">of</span> <span class="variable">tips</span> <span class="variable">with</span> <span class="variable">value</span> <span class="operator">x:</span>
  
   <span class="variable">pick</span> <span class="variable">the</span> <span class="variable">internal</span> <span class="variable">node</span> <span class="variable">with</span> <span class="variable">maximim</span> <span class="variable">value</span> <span class="keyword">for</span>
      <span class="variable">number</span> <span class="variable">of</span> <span class="variable">of</span> <span class="variable">tips</span> <span class="variable">with</span> <span class="variable">only</span> <span class="variable">trait</span> <span class="operator">x</span>
  
  <span class="variable">MC</span> <span class="variable">was</span> <span class="keyword">defined</span> <span class="variable">by</span> <span class="variable">Parker</span> <span class="variable">et</span> <span class="variable">al</span> <span class="number">2008.</span>
  
  <span class="variable">Salemi</span><span class="operator">,</span> <span class="variable">M</span><span class="operator">.,</span> <span class="variable">Lamers</span><span class="operator">,</span> <span class="variable">S</span><span class="operator">.</span><span class="variable">L</span><span class="operator">.,</span> <span class="variable">Yu</span><span class="operator">,</span> <span class="variable">S</span><span class="operator">.,</span> <span class="variable">de</span> <span class="variable">Oliveira</span><span class="operator">,</span> <span class="variable">T</span><span class="operator">.,</span> <span class="variable">Fitch</span><span class="operator">,</span> <span class="variable">W</span><span class="operator">.</span><span class="variable">M</span><span class="operator">.,</span> <span class="variable">McGrath</span><span class="operator">,</span> <span class="variable">M</span><span class="operator">.</span><span class="variable">S</span><span class="operator">.,</span>
   <span class="number">2005.</span> <span class="variable">Phylodynamic</span> <span class="variable">analysis</span> <span class="variable">of</span> <span class="variable">Human</span> <span class="variable">Immunode</span>ﬁ<span class="variable">ciency</span> <span class="variable">Virus</span> <span class="variable">Type</span> <span class="number">1</span> <span class="variable">in</span>
   <span class="variable">distinct</span> <span class="variable">brain</span> <span class="variable">compartments</span> <span class="variable">provides</span> <span class="variable">a</span> <span class="variable">model</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">neuropathogenesis</span> <span class="variable">of</span>
   <span class="variable">AIDS</span><span class="operator">.</span> <span class="variable">J</span><span class="operator">.</span> <span class="variable">Virol</span><span class="operator">.</span> <span class="number">79</span> <span class="operator">(</span><span class="number">17</span><span class="operator">),</span> <span class="number">11343</span><span class="operator">-</span><span class="number">11352.</span>
  
  <span class="variable">Parker</span><span class="operator">,</span> <span class="variable">J</span><span class="operator">.,</span> <span class="variable">Rambaut</span> <span class="variable">A</span><span class="operator">.,</span> <span class="variable">Pybus</span> <span class="variable">O</span><span class="operator">.,</span> <span class="number">2008.</span> <span class="variable">Correlating</span> <span class="variable">viral</span> <span class="variable">phenotypes</span>
   <span class="variable">with</span> <span class="variable">phylogeny</span><span class="operator">:</span> <span class="variable">Accounting</span> <span class="keyword">for</span> <span class="variable">phylogenetic</span> <span class="variable">uncertainty</span> <span class="variable">Infection</span><span class="operator">,</span>
   <span class="variable">Genetics</span> <span class="keyword">and</span> <span class="variable">Evolution</span> <span class="number">8</span> <span class="operator">(</span><span class="number">2008</span><span class="operator">),</span> <span class="number">239</span><span class="operator">-</span><span class="number">246.</span>
</code></code></pre>

<h1 id="POD-ERRORS">POD ERRORS</h1>

<p>Hey! <b>The above document had some coding errors, which are explained below:</b></p>

<dl>

<dt id="Around-line-214:">Around line 214:</dt>
<dd>

<p>Non-ASCII character seen before =encoding in &#39;de&#xFB01;ning&#39;. Assuming UTF-8</p>

</dd>
</dl>


</body>

</html>


