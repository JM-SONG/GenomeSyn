<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#FEEDBACK">FEEDBACK</a>
    <ul>
      <li><a href="#Mailing-Lists">Mailing Lists</a></li>
      <li><a href="#Support">Support</a></li>
      <li><a href="#Reporting-Bugs">Reporting Bugs</a></li>
    </ul>
  </li>
  <li><a href="#AUTHOR---Jason-Stajich-Aaron-Mackey-Justin-Reese">AUTHOR - Jason Stajich, Aaron Mackey, Justin Reese</a></li>
  <li><a href="#CONTRIBUTORS">CONTRIBUTORS</a></li>
  <li><a href="#APPENDIX">APPENDIX</a>
    <ul>
      <li><a href="#find_node">find_node</a></li>
      <li><a href="#remove_Node">remove_Node</a></li>
      <li><a href="#get_lineage_nodes">get_lineage_nodes</a></li>
      <li><a href="#splice">splice</a></li>
      <li><a href="#get_lca">get_lca</a></li>
      <li><a href="#merge_lineage">merge_lineage</a></li>
      <li><a href="#contract_linear_paths">contract_linear_paths</a></li>
      <li><a href="#is_binary">is_binary</a></li>
      <li><a href="#force_binary">force_binary</a></li>
      <li><a href="#simplify_to_leaves_string">simplify_to_leaves_string</a></li>
      <li><a href="#distance">distance</a></li>
      <li><a href="#is_monophyletic">is_monophyletic</a></li>
      <li><a href="#is_paraphyletic">is_paraphyletic</a></li>
      <li><a href="#reroot">reroot</a></li>
      <li><a href="#reroot_at_midpoint">reroot_at_midpoint</a></li>
      <li><a href="#findnode_by_id">findnode_by_id</a></li>
      <li><a href="#move_id_to_bootstrap">move_id_to_bootstrap</a></li>
      <li><a href="#add_trait">add_trait</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Bio::Tree::TreeFunctionsI - Decorated Interface implementing basic Tree exploration methods</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Bio::TreeIO</span><span class="operator">;</span>
  <span class="keyword">my</span> <span class="variable">$in</span> <span class="operator">=</span> <span class="variable">Bio::TreeIO</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="string">-format</span> <span class="operator">=&gt;</span> <span class="string">'newick'</span><span class="operator">,</span> <span class="string">-file</span> <span class="operator">=&gt;</span> <span class="string">'tree.tre'</span><span class="operator">);</span>
  
  <span class="keyword">my</span> <span class="variable">$tree</span> <span class="operator">=</span> <span class="variable">$in</span><span class="operator">-&gt;</span><span class="variable">next_tree</span><span class="operator">;</span>
  
  <span class="keyword">my</span> <span class="variable">@nodes</span> <span class="operator">=</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">find_node</span><span class="operator">(</span><span class="string">'id1'</span><span class="operator">);</span>
  
  <span class="keyword">if</span><span class="operator">(</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">is_monophyletic</span><span class="operator">(</span><span class="string">-nodes</span> <span class="operator">=&gt;</span> <span class="operator">\</span><span class="variable">@nodes</span><span class="operator">,</span> <span class="string">-outgroup</span> <span class="operator">=&gt;</span> <span class="variable">$outnode</span><span class="operator">)</span> <span class="operator">){</span>
   <span class="comment">#...</span>
  <span class="operator">}</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This interface provides a set of implementated Tree functions which only use the defined methods in the TreeI or NodeI interface.</p>

<h1 id="FEEDBACK">FEEDBACK</h1>

<h2 id="Mailing-Lists">Mailing Lists</h2>

<p>User feedback is an integral part of the evolution of this and other Bioperl modules. Send your comments and suggestions preferably to the Bioperl mailing list. Your participation is much appreciated.</p>

<pre><code><code>  bioperl-l@bioperl.org                  - General discussion
  http://bioperl.org/wiki/Mailing_lists  - About the mailing lists</code></code></pre>

<h2 id="Support">Support</h2>

<p>Please direct usage questions or support issues to the mailing list:</p>

<p><i>bioperl-l@bioperl.org</i></p>

<p>rather than to the module maintainer directly. Many experienced and reponsive experts will be able look at the problem and quickly address it. Please include a thorough description of the problem with code and data examples if at all possible.</p>

<h2 id="Reporting-Bugs">Reporting Bugs</h2>

<p>Report bugs to the Bioperl bug tracking system to help us keep track of the bugs and their resolution. Bug reports can be submitted via the web:</p>

<pre><code><code>  https://redmine.open-bio.org/projects/bioperl/</code></code></pre>

<h1 id="AUTHOR---Jason-Stajich-Aaron-Mackey-Justin-Reese">AUTHOR - Jason Stajich, Aaron Mackey, Justin Reese</h1>

<p>Email jason-at-bioperl-dot-org Email amackey-at-virginia.edu Email jtr4v-at-virginia.edu</p>

<h1 id="CONTRIBUTORS">CONTRIBUTORS</h1>

<p>Sendu Bala, bix@sendu.me.uk</p>

<p>Rerooting code was worked on by</p>

<pre><code><code>  Daniel Barker d.barker-at-reading.ac.uk
  Ramiro Barrantes Ramiro.Barrantes-at-uvm.edu</code></code></pre>

<h1 id="APPENDIX">APPENDIX</h1>

<p>The rest of the documentation details each of the object methods. Internal methods are usually preceded with a _</p>

<h2 id="find_node">find_node</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">find_node</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">@nodes</span> <span class="operator">=</span> <span class="variable">$self</span><span class="operator">-&gt;</span><span class="variable">find_node</span><span class="operator">(</span><span class="string">-id</span> <span class="operator">=&gt;</span> <span class="string">'node1'</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">returns</span> <span class="variable">all</span> <span class="variable">nodes</span> <span class="variable">that</span> <span class="variable">match</span> <span class="variable">a</span> <span class="variable">specific</span> <span class="variable">field</span><span class="operator">,</span> <span class="variable">by</span> <span class="keyword">default</span> <span class="variable">this</span>
           <span class="variable">is</span> <span class="variable">id</span><span class="operator">,</span> <span class="variable">but</span> <span class="variable">different</span> <span class="variable">branch_length</span><span class="operator">,</span> 
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">List</span> <span class="variable">of</span> <span class="variable">nodes</span> <span class="variable">which</span> <span class="variable">matched</span> <span class="variable">search</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">text</span> <span class="variable">string</span> <span class="variable">to</span> <span class="variable">search</span> <span class="keyword">for</span>
           <span class="variable">OR</span>
           <span class="operator">-</span><span class="string">fieldname</span> <span class="operator">=&gt;</span> <span class="variable">$textstring</span>
</code></code></pre>

<h2 id="remove_Node">remove_Node</h2>

<pre><code><code> Title   : remove_Node
 Usage   : $tree-&gt;remove_Node($node)
 Function: Removes a node from the tree
 Returns : boolean represent status of success
 Args    : either Bio::Tree::NodeI or string of the node id</code></code></pre>

<h2 id="get_lineage_nodes">get_lineage_nodes</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">get_lineage_nodes</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">@nodes</span> <span class="operator">=</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">get_lineage_nodes</span><span class="operator">(</span><span class="variable">$node</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">the</span> <span class="variable">full</span> <span class="variable">lineage</span> <span class="variable">of</span> <span class="variable">a</span> <span class="variable">node</span> <span class="operator">(</span><span class="variable">all</span> <span class="variable">its</span> <span class="variable">ancestors</span><span class="operator">,</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">order</span>
           <span class="variable">root</span><span class="operator">-&gt;</span><span class="variable">most</span> <span class="variable">recent</span> <span class="variable">ancestor</span><span class="operator">)</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">nodes</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">either</span> <span class="variable">Bio::Tree::NodeI</span> <span class="keyword">or</span> <span class="variable">string</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">node</span> <span class="variable">id</span>
</code></code></pre>

<h2 id="splice">splice</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="keyword">splice</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">splice</span><span class="operator">(</span><span class="string">-remove_id</span> <span class="operator">=&gt;</span> <span class="operator">\</span><span class="variable">@ids</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Remove</span> <span class="variable">all</span> <span class="variable">the</span> <span class="variable">nodes</span> <span class="variable">from</span> <span class="variable">a</span> <span class="variable">tree</span> <span class="variable">that</span> <span class="variable">correspond</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">supplied</span>
           <span class="variable">args</span><span class="operator">,</span> <span class="variable">making</span> <span class="variable">all</span> <span class="variable">the</span> <span class="variable">descendents</span> <span class="variable">of</span> <span class="variable">a</span> <span class="variable">removed</span> <span class="variable">node</span> <span class="variable">the</span> <span class="variable">descendents</span>
           <span class="variable">of</span> <span class="variable">the</span> <span class="variable">removed</span> <span class="variable">node's</span> <span class="variable">ancestor</span><span class="operator">.</span>
           <span class="variable">You</span> <span class="variable">can</span> <span class="variable">ask</span> <span class="variable">to</span> <span class="variable">explicitly</span> <span class="variable">remove</span> <span class="variable">certain</span> <span class="variable">nodes</span> <span class="variable">by</span> <span class="variable">using</span> <span class="operator">-</span><span class="variable">remove_</span><span class="operator">*,</span>
           <span class="variable">remove</span> <span class="variable">them</span> <span class="variable">conditionally</span> <span class="variable">by</span> <span class="variable">using</span> <span class="operator">-</span><span class="variable">remove_</span><span class="operator">*</span> <span class="variable">in</span> <span class="variable">combination</span> <span class="variable">with</span>
           <span class="operator">-</span><span class="variable">keep_</span><span class="operator">*,</span> <span class="keyword">or</span> <span class="variable">remove</span> <span class="variable">everything</span> <span class="variable">except</span> <span class="variable">certain</span> <span class="variable">nodes</span> <span class="variable">by</span> <span class="variable">using</span> <span class="variable">only</span>
           <span class="operator">-</span><span class="variable">keep_</span><span class="operator">*.</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">n</span><span class="operator">/</span><span class="variable">a</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">just</span> <span class="variable">a</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">objects</span> <span class="variable">to</span> <span class="variable">remove</span><span class="operator">,</span> <span class="variable">OR</span>
           <span class="operator">-</span><span class="string">key</span> <span class="operator">=&gt;</span> <span class="variable">value</span> <span class="variable">pairs</span><span class="operator">,</span> <span class="variable">where</span> <span class="operator">-</span><span class="variable">key</span> <span class="variable">has</span> <span class="variable">the</span> <span class="variable">prefix</span> <span class="string">'remove'</span> <span class="keyword">or</span> <span class="string">'keep'</span><span class="operator">,</span>
           <span class="variable">followed</span> <span class="variable">by</span> <span class="variable">an</span> <span class="variable">underscore</span><span class="operator">,</span> <span class="variable">followed</span> <span class="variable">by</span> <span class="variable">a</span> <span class="variable">fieldname</span> <span class="operator">(</span><span class="variable">like</span> <span class="keyword">for</span> <span class="variable">the</span>
           <span class="variable">method</span> <span class="variable">find_node</span><span class="operator">).</span> <span class="variable">Value</span> <span class="variable">should</span> <span class="variable">be</span> <span class="variable">a</span> <span class="keyword">scalar</span> <span class="keyword">or</span> <span class="variable">an</span> <span class="variable">array</span> <span class="keyword">ref</span> <span class="variable">of</span>
           <span class="variable">scalars</span> <span class="operator">(</span><span class="variable">again</span><span class="operator">,</span> <span class="variable">like</span> <span class="variable">you</span> <span class="variable">might</span> <span class="variable">supply</span> <span class="variable">to</span> <span class="variable">find_node</span><span class="operator">).</span>
 
           <span class="variable">So</span> <span class="operator">(</span><span class="string">-remove_id</span> <span class="operator">=&gt;</span> <span class="operator">[</span><span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="operator">]</span><span class="operator">)</span> <span class="variable">will</span> <span class="variable">remove</span> <span class="variable">all</span> <span class="variable">nodes</span> <span class="variable">from</span> <span class="variable">the</span> <span class="variable">tree</span> <span class="variable">that</span>
           <span class="variable">have</span> <span class="variable">an</span> <span class="variable">id</span><span class="operator">()</span> <span class="variable">of</span> <span class="string">'1'</span> <span class="keyword">or</span> <span class="string">'2'</span><span class="operator">,</span> <span class="keyword">while</span>
           <span class="operator">(</span><span class="string">-remove_id</span> <span class="operator">=&gt;</span> <span class="operator">[</span><span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="operator">]</span><span class="operator">,</span> <span class="string">-keep_id</span> <span class="operator">=&gt;</span> <span class="operator">[</span><span class="number">2</span><span class="operator">]</span><span class="operator">)</span> <span class="variable">will</span> <span class="variable">remove</span> <span class="variable">all</span> <span class="variable">nodes</span> <span class="variable">with</span>
           <span class="variable">an</span> <span class="variable">id</span><span class="operator">()</span> <span class="variable">of</span> <span class="string">'1'</span><span class="operator">.</span>
           <span class="operator">(</span><span class="string">-keep_id</span> <span class="operator">=&gt;</span> <span class="operator">[</span><span class="number">2</span><span class="operator">]</span><span class="operator">)</span> <span class="variable">will</span> <span class="variable">remove</span> <span class="variable">all</span> <span class="variable">nodes</span> <span class="keyword">unless</span> <span class="variable">they</span> <span class="variable">have</span> <span class="variable">an</span> <span class="variable">id</span><span class="operator">()</span> <span class="variable">of</span>
           <span class="string">'2'</span> <span class="operator">(</span><span class="variable">note</span><span class="operator">,</span> <span class="keyword">no</span> <span class="operator">-</span><span class="variable">remove_</span><span class="operator">*).</span>
 
           <span class="string">-preserve_lengths</span> <span class="operator">=&gt;</span> <span class="number">1</span> <span class="operator">:</span> <span class="variable">setting</span> <span class="variable">this</span> <span class="variable">argument</span> <span class="variable">will</span> <span class="keyword">splice</span> <span class="variable">out</span>
           <span class="variable">intermediate</span> <span class="variable">nodes</span><span class="operator">,</span> <span class="variable">preserving</span> <span class="variable">the</span> <span class="variable">original</span> <span class="variable">total</span> <span class="keyword">length</span> <span class="variable">between</span>
           <span class="variable">the</span> <span class="variable">ancestor</span> <span class="keyword">and</span> <span class="variable">the</span> <span class="variable">descendants</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">spliced</span> <span class="variable">node</span><span class="operator">.</span> <span class="variable">Undef</span> 
           <span class="variable">by</span> <span class="keyword">default</span><span class="operator">.</span>
</code></code></pre>

<h2 id="get_lca">get_lca</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">get_lca</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">get_lca</span><span class="operator">(</span><span class="string">-nodes</span> <span class="operator">=&gt;</span> <span class="operator">\</span><span class="variable">@nodes</span> <span class="operator">);</span> <span class="variable">OR</span>
           <span class="variable">get_lca</span><span class="operator">(</span><span class="variable">@nodes</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="keyword">given</span> <span class="variable">two</span> <span class="keyword">or</span> <span class="variable">more</span> <span class="variable">nodes</span><span class="operator">,</span> <span class="variable">returns</span> <span class="variable">the</span> <span class="variable">lowest</span> <span class="variable">common</span> <span class="variable">ancestor</span> <span class="operator">(</span><span class="variable">aka</span> <span class="variable">most</span>
           <span class="variable">recent</span> <span class="variable">common</span> <span class="variable">ancestor</span><span class="operator">)</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">node</span> <span class="variable">object</span> <span class="keyword">or</span> <span class="keyword">undef</span> <span class="keyword">if</span> <span class="variable">there</span> <span class="variable">is</span> <span class="keyword">no</span> <span class="variable">common</span> <span class="variable">ancestor</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="string">-nodes</span> <span class="operator">=&gt;</span> <span class="variable">arrayref</span> <span class="variable">of</span> <span class="variable">nodes</span> <span class="variable">to</span> <span class="variable">test</span><span class="operator">,</span> <span class="variable">OR</span>
           <span class="variable">just</span> <span class="variable">a</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">nodes</span>
</code></code></pre>

<h2 id="merge_lineage">merge_lineage</h2>

<pre><code><code> Title   : merge_lineage
 Usage   : merge_lineage($node)
 Function: Merge a lineage of nodes with this tree.
 Returns : n/a
 Args    : Bio::Tree::TreeI with only one leaf, OR
           Bio::Tree::NodeI which has an ancestor

 For example, if we are the tree $tree:

 +---B
 |
 A
 |
 +---C

 and we want to merge the lineage $other_tree:

 A---C---D

 After calling $tree-&gt;merge_lineage($other_tree), $tree looks like:

 +---B
 |
 A
 |
 +---C---D</code></code></pre>

<h2 id="contract_linear_paths">contract_linear_paths</h2>

<pre><code><code> Title   : contract_linear_paths
 Usage   : contract_linear_paths()
 Function: Splices out all nodes in the tree that have an ancestor and only one
           descendent.
 Returns : n/a
 Args    : none for normal behaviour, true to dis-regard the ancestor requirment
           and re-root the tree as necessary

 For example, if we are the tree $tree:

             +---E
             |
 A---B---C---D
             |
             +---F

 After calling $tree-&gt;contract_linear_paths(), $tree looks like:

     +---E
     |
 A---D
     |
     +---F

 Instead, $tree-&gt;contract_linear_paths(1) would have given:

 +---E
 |
 D
 |
 +---F</code></code></pre>

<h2 id="is_binary">is_binary</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">is_binary</span><span class="operator">();</span> <span class="variable">is_binary</span><span class="operator">(</span><span class="variable">$node</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Finds</span> <span class="keyword">if</span> <span class="variable">the</span> <span class="variable">tree</span> <span class="keyword">or</span> <span class="variable">subtree</span> <span class="keyword">defined</span> <span class="variable">by</span>
               <span class="variable">the</span> <span class="variable">internal</span> <span class="variable">node</span> <span class="variable">is</span> <span class="variable">a</span> <span class="variable">true</span> <span class="variable">binary</span> <span class="variable">tree</span>
               <span class="variable">without</span> <span class="variable">polytomies</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">boolean</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> 
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="variable">Internal</span> <span class="variable">node</span> <span class="variable">Bio::Tree::NodeI</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="force_binary">force_binary</h2>

<pre><code><code> Title   : force_binary
 Usage   : force_binary()
 Function: Forces the tree into a binary tree, splitting branches arbitrarily
           and creating extra nodes as necessary, such that all nodes have
           exactly two or zero descendants.
 Returns : n/a
 Args    : none

 For example, if we are the tree $tree:

 +---G
 |
 +---F
 |
 +---E
 |
 A
 |
 +---D
 |
 +---C
 |
 +---B

 (A has 6 descendants B-G)

 After calling $tree-&gt;force_binary(), $tree looks like:

         +---X
         |
     +---X
     |   |
     |   +---X
     |
 +---X
 |   |
 |   |   +---G
 |   |   |
 |   +---X
 |       |
 |       +---F
 A
 |       +---E
 |       |
 |   +---X
 |   |   |
 |   |   +---D
 |   |
 +---X
     |
     |   +---C
     |   |
     +---X
         |
         +---B

 (Where X are artificially created nodes with ids &#39;artificial_n&#39;, where n is
 an integer making the id unique within the tree)</code></code></pre>

<h2 id="simplify_to_leaves_string">simplify_to_leaves_string</h2>

<pre><code><code> Title   : simplify_to_leaves_string
 Usage   : my $leaves_string = $tree-&gt;simplify_to_leaves_string()
 Function: Creates a simple textual representation of the relationship between
           leaves in self. It forces the tree to be binary, so the result may
           not strictly correspond to the tree (if the tree wasn&#39;t binary), but
           will be as close as possible. The tree object is not altered. Only
           leaf node ids are output, in a newick-like format.
 Returns : string
 Args    : none</code></code></pre>

<h2 id="distance">distance</h2>

<pre><code><code> Title   : distance
 Usage   : distance(-nodes =&gt; \@nodes )
 Function: returns the distance between two given nodes
 Returns : numerical distance
 Args    : -nodes =&gt; arrayref of nodes to test
           or ($node1, $node2)</code></code></pre>

<h2 id="is_monophyletic">is_monophyletic</h2>

<pre><code><code> Title   : is_monophyletic
 Usage   : if( $tree-&gt;is_monophyletic(-nodes =&gt; \@nodes, 
                                      -outgroup =&gt; $outgroup)
 Function: Will do a test of monophyly for the nodes specified
           in comparison to a chosen outgroup
 Returns : boolean
 Args    : -nodes    =&gt; arrayref of nodes to test
           -outgroup =&gt; outgroup to serve as a reference</code></code></pre>

<h2 id="is_paraphyletic">is_paraphyletic</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">is_paraphyletic</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">if</span><span class="operator">(</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">is_paraphyletic</span><span class="operator">(</span><span class="string">-nodes</span> <span class="operator">=&gt;\</span><span class="variable">@nodes</span><span class="operator">,</span>
                                      <span class="string">-outgroup</span> <span class="operator">=&gt;</span> <span class="variable">$node</span><span class="operator">)</span> <span class="operator">){</span> <span class="operator">}</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Tests</span> <span class="variable">whether</span> <span class="keyword">or</span> <span class="keyword">not</span> <span class="variable">a</span> <span class="keyword">given</span> <span class="variable">set</span> <span class="variable">of</span> <span class="variable">nodes</span> <span class="variable">are</span> <span class="variable">paraphyletic</span>
           <span class="operator">(</span><span class="variable">representing</span> <span class="variable">the</span> <span class="variable">full</span> <span class="variable">clade</span><span class="operator">)</span> <span class="keyword">given</span> <span class="variable">an</span> <span class="variable">outgroup</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="operator">[</span><span class="operator">-</span><span class="number">1</span><span class="operator">,</span><span class="number">0</span><span class="operator">,</span><span class="number">1</span><span class="operator">]</span> <span class="operator">,</span> <span class="operator">-</span><span class="number">1</span> <span class="keyword">if</span> <span class="variable">the</span> <span class="variable">group</span> <span class="variable">is</span> <span class="keyword">not</span> <span class="variable">monophyletic</span>
                       <span class="number">0</span> <span class="keyword">if</span> <span class="variable">the</span> <span class="variable">group</span> <span class="variable">is</span> <span class="keyword">not</span> <span class="variable">paraphyletic</span>
                       <span class="number">1</span> <span class="keyword">if</span> <span class="variable">the</span> <span class="variable">group</span> <span class="variable">is</span> <span class="variable">paraphyletic</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="string">-nodes</span> <span class="operator">=&gt;</span> <span class="variable">Array</span> <span class="variable">of</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">objects</span> <span class="variable">which</span> <span class="variable">are</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">tree</span>
           <span class="operator">-</span><span class="string">outgroup</span> <span class="operator">=&gt;</span> <span class="variable">a</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">to</span> <span class="variable">compare</span> <span class="variable">the</span> <span class="variable">nodes</span> <span class="variable">to</span>
</code></code></pre>

<h2 id="reroot">reroot</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">reroot</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">reroot</span><span class="operator">(</span><span class="variable">$node</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Reroots</span> <span class="variable">a</span> <span class="variable">tree</span> <span class="variable">making</span> <span class="variable">a</span> <span class="variable">new</span> <span class="variable">node</span> <span class="variable">the</span> <span class="variable">root</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="variable">on</span> <span class="variable">success</span><span class="operator">,</span> <span class="number">0</span> <span class="variable">on</span> <span class="variable">failure</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">that</span> <span class="variable">is</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">,</span> <span class="variable">but</span> <span class="variable">is</span> <span class="keyword">not</span> <span class="variable">the</span> <span class="variable">current</span> <span class="variable">root</span>
</code></code></pre>

<h2 id="reroot_at_midpoint">reroot_at_midpoint</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">reroot_at_midpoint</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">reroot_at_midpoint</span><span class="operator">(</span><span class="variable">$node</span><span class="operator">,</span> <span class="variable">$new_root_id</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Reroots</span> <span class="variable">a</span> <span class="variable">tree</span> <span class="variable">on</span> <span class="variable">a</span> <span class="variable">new</span> <span class="variable">node</span> <span class="variable">created</span> <span class="variable">halfway</span> <span class="variable">between</span> <span class="variable">the</span> 
           <span class="variable">argument</span> <span class="keyword">and</span> <span class="variable">its</span> <span class="variable">ancestor</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">the</span> <span class="variable">new</span> <span class="variable">midpoint</span> <span class="variable">Bio::Tree::NodeIon</span> <span class="variable">success</span><span class="operator">,</span> <span class="number">0</span> <span class="variable">on</span> <span class="variable">failure</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">non</span><span class="operator">-</span><span class="variable">root</span> <span class="variable">Bio::Tree::NodeI</span> <span class="variable">currently</span> <span class="variable">in</span> <span class="variable">$tree</span>
           <span class="keyword">scalar</span> <span class="variable">string</span><span class="operator">,</span> <span class="variable">id</span> <span class="keyword">for</span> <span class="variable">new</span> <span class="variable">node</span> <span class="operator">(</span><span class="variable">optional</span><span class="operator">)</span>
</code></code></pre>

<h2 id="findnode_by_id">findnode_by_id</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">findnode_by_id</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$node</span> <span class="operator">=</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">findnode_by_id</span><span class="operator">(</span><span class="variable">$id</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">a</span> <span class="variable">node</span> <span class="variable">by</span> <span class="variable">its</span> <span class="variable">id</span> <span class="operator">(</span><span class="variable">which</span> <span class="variable">should</span> <span class="variable">be</span> 
           <span class="variable">unique</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">tree</span><span class="operator">)</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">Bio::Tree::NodeI</span><span class="operator">&gt;</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">node</span> <span class="variable">id</span>
</code></code></pre>

<h2 id="move_id_to_bootstrap">move_id_to_bootstrap</h2>

<pre><code><code> Title   : move_id_to_bootstrap
 Usage   : $tree-&gt;move_id_to_bootstrap
 Function: Move internal IDs to bootstrap slot
 Returns : undef
 Args    : undef</code></code></pre>

<h2 id="add_trait">add_trait</h2>

<pre><code><code>  <span class="variable">Example</span>    <span class="operator">:</span> <span class="variable">$key</span> <span class="operator">=</span> <span class="variable">$tree</span><span class="operator">-&gt;</span><span class="variable">add_trait</span><span class="operator">(</span><span class="variable">$trait_file</span><span class="operator">,</span> <span class="number">3</span><span class="operator">);</span>
  <span class="variable">Description</span><span class="operator">:</span> <span class="variable">Add</span> <span class="variable">traits</span> <span class="variable">to</span> <span class="variable">a</span> <span class="variable">Bio::Tree</span><span class="operator">:</span><span class="variable">Tree</span> <span class="variable">nodes</span>
               <span class="variable">of</span> <span class="variable">a</span> <span class="variable">tree</span> <span class="variable">from</span> <span class="variable">a</span> <span class="variable">file</span><span class="operator">.</span>
  <span class="variable">Returns</span>    <span class="operator">:</span> <span class="variable">trait</span> <span class="variable">name</span>
  <span class="variable">Exceptions</span> <span class="operator">:</span> <span class="keyword">log</span> <span class="variable">an</span> <span class="variable">error</span> <span class="keyword">if</span> <span class="variable">a</span> <span class="variable">node</span> <span class="variable">has</span> <span class="keyword">no</span> <span class="variable">value</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">file</span>
  <span class="variable">Args</span>       <span class="operator">:</span> <span class="variable">name</span> <span class="variable">of</span> <span class="variable">trait</span> <span class="variable">file</span> <span class="operator">(</span><span class="keyword">scalar</span> <span class="variable">string</span><span class="operator">),</span> 
               <span class="keyword">index</span> <span class="variable">of</span> <span class="variable">trait</span> <span class="variable">file</span> <span class="variable">column</span> <span class="operator">(</span><span class="keyword">scalar</span> <span class="keyword">int</span><span class="operator">)</span>
  <span class="variable">Caller</span>     <span class="operator">:</span> <span class="variable">main</span><span class="operator">()</span>
</code></code></pre>

<p>The trait file is a tab-delimited text file and needs to have a header line giving names to traits. The first column contains the leaf node ids. Subsequent columns contain different trait value sets. Columns numbering starts from 0. The default trait column is the second (1). The returned hashref has one special key, my_trait_name, that holds the trait name. Single or double quotes are removed.</p>


</body>

</html>


