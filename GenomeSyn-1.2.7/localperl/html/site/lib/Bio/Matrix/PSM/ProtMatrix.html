<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#FEEDBACK">FEEDBACK</a>
    <ul>
      <li><a href="#Mailing-Lists">Mailing Lists</a></li>
      <li><a href="#Support">Support</a></li>
      <li><a href="#Reporting-Bugs">Reporting Bugs</a></li>
    </ul>
  </li>
  <li><a href="#AUTHOR---James-Thompson">AUTHOR - James Thompson</a></li>
  <li><a href="#APPENDIX">APPENDIX</a>
    <ul>
      <li><a href="#new">new</a></li>
      <li><a href="#alphabet">alphabet</a></li>
      <li><a href="#calculate_consensus">_calculate_consensus</a></li>
      <li><a href="#next_pos">next_pos</a></li>
      <li><a href="#curpos">curpos</a></li>
      <li><a href="#e_val">e_val</a></li>
      <li><a href="#IC">IC</a></li>
      <li><a href="#accession_number">accession_number</a></li>
      <li><a href="#consensus">consensus</a></li>
      <li><a href="#get_string">get_string</a></li>
      <li><a href="#width">width</a></li>
      <li><a href="#get_array">get_array</a></li>
      <li><a href="#get_logs_array">get_logs_array</a></li>
      <li><a href="#id">id</a></li>
      <li><a href="#regexp">regexp</a></li>
      <li><a href="#regexp_array">regexp_array</a></li>
      <li><a href="#compress_array">_compress_array</a></li>
      <li><a href="#uncompress_string">_uncompress_string</a></li>
      <li><a href="#get_compressed_freq">get_compressed_freq</a></li>
      <li><a href="#sequence_match_weight">sequence_match_weight</a></li>
      <li><a href="#to_IUPAC">_to_IUPAC</a></li>
      <li><a href="#to_cons">_to_cons</a></li>
      <li><a href="#get_all_vectors">get_all_vectors</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Bio::Matrix::PSM::ProtMatrix - SiteMatrixI implementation, holds a position scoring matrix (or position weight matrix) with log-odds scoring information.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>   <span class="keyword">use</span> <span class="variable">Bio::Matrix::PSM::ProtMatrix</span><span class="operator">;</span>
   <span class="comment"># Create from memory by supplying probability matrix hash both as strings or</span>
   <span class="comment"># arrays where the frequencies   Hash entries of the form lN refer to an array</span>
   <span class="comment"># of position-specific log-odds scores for amino acid N. Hash entries of the</span>
   <span class="comment"># form pN represent the position-specific probability of finding amino acid N.</span>
   
   <span class="keyword">my</span> <span class="variable">%param</span> <span class="operator">=</span> <span class="operator">(</span>
             <span class="string">'id'</span> <span class="operator">=&gt;</span> <span class="string">'A. thaliana protein atp1'</span><span class="operator">,</span>
             <span class="string">'-e_val'</span> <span class="operator">=&gt;</span> <span class="variable">$score</span><span class="operator">,</span>
             <span class="string">'lS'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lF'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-4'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lT'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'1'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lN'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'5'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lK'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-1'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lY'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-4'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lE'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'4'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'2'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lV'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lQ'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lM'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'8'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'8'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lC'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lL'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-4'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lA'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'2'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lW'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'-5'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lP'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'6'</span><span class="operator">,</span> <span class="string">'-3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lH'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lD'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'4'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lR'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'4'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lI'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'6'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-2'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'lG'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-4'</span><span class="operator">,</span> <span class="string">'-2'</span><span class="operator">,</span> <span class="string">'-5'</span><span class="operator">,</span> <span class="string">'-3'</span><span class="operator">,</span> <span class="string">'-1'</span><span class="operator">,</span> <span class="string">'-2'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pS'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'33'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'16'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'12'</span><span class="operator">,</span> <span class="string">'11'</span><span class="operator">,</span> <span class="string">'25'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pF'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pT'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'8'</span><span class="operator">,</span> <span class="string">'7'</span><span class="operator">,</span> <span class="string">'10'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'7'</span><span class="operator">,</span> <span class="string">'8'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pN'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'13'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'36'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'4'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pK'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'5'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'13'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'15'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'2'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pY'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pE'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'41'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'12'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'15'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pV'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'9'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'1'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pQ'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'15'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'4'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pM'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'100'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'66'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pC'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pL'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'8'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'25'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'4'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pA'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'10'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'9'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'22'</span><span class="operator">,</span> <span class="string">'16'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pW'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pP'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'45'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pH'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pD'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'7'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'22'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pR'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'27'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pI'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'3'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'59'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'2'</span><span class="operator">,</span> <span class="string">'3'</span> <span class="operator">]</span><span class="operator">,</span>
             <span class="string">'pG'</span> <span class="operator">=&gt;</span> <span class="operator">[</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'1'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'0'</span><span class="operator">,</span> <span class="string">'4'</span><span class="operator">,</span> <span class="string">'1'</span> <span class="operator">]</span><span class="operator">,</span>
   <span class="operator">);</span>
   
   <span class="keyword">my</span> <span class="variable">$matrix</span> <span class="operator">=</span> <span class="variable">Bio::Matrix::PSM::ProtMatrix</span><span class="operator">(</span> <span class="variable">%param</span> <span class="operator">);</span>
   
   
   <span class="keyword">my</span> <span class="variable">$site</span> <span class="operator">=</span> <span class="variable">Bio::Matrix::PSM::ProtMatrix</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="variable">%param</span><span class="operator">);</span>
   <span class="comment"># Or get it from a file:</span>
   <span class="keyword">use</span> <span class="variable">Bio::Matrix::PSM::IO</span><span class="operator">;</span>
   <span class="keyword">my</span> <span class="variable">$psmIO</span> <span class="operator">=</span> <span class="variable">Bio::Matrix::PSM::IO</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span><span class="string">-file</span> <span class="operator">=&gt;</span> <span class="variable">$file</span><span class="operator">,</span> <span class="string">-format</span> <span class="operator">=&gt;</span> <span class="string">'psi-blast'</span><span class="operator">);</span>
   <span class="keyword">while</span> <span class="operator">(</span><span class="keyword">my</span> <span class="variable">$psm</span> <span class="operator">=</span> <span class="variable">$psmIO</span><span class="operator">-&gt;</span><span class="variable">next_psm</span><span class="operator">)</span> <span class="operator">{</span>
      <span class="comment">#Now we have a Bio::Matrix::PSM::Psm object, </span>
      <span class="comment"># see Bio::Matrix::PSM::PsmI for details</span>
      <span class="comment">#This is a Bio::Matrix::PSM::ProtMatrix object now</span>
      <span class="keyword">my</span> <span class="variable">$matrix</span> <span class="operator">=</span> <span class="variable">$psm</span><span class="operator">-&gt;</span><span class="variable">matrix</span><span class="operator">;</span>   
   <span class="operator">}</span>
   
   <span class="comment"># Get a simple consensus, where alphabet is:</span>
   <span class="comment"># {A, R, N, D, C, Q, E, G, H, I, L, K, M, F, P, S, T, W, Y, V,}</span>
   <span class="comment"># choosing the highest probability or N if prob is too low</span>
   <span class="keyword">my</span> <span class="variable">$consensus</span> <span class="operator">=</span> <span class="variable">$site</span><span class="operator">-&gt;</span><span class="variable">consensus</span><span class="operator">;</span>
   
   <span class="comment"># Retrieving and using regular expressions:</span>
   <span class="keyword">my</span> <span class="variable">$regexp</span> <span class="operator">=</span> <span class="variable">$site</span><span class="operator">-&gt;</span><span class="variable">regexp</span><span class="operator">;</span>
   <span class="keyword">my</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="keyword">grep</span><span class="operator">(</span><span class="variable">$regexp</span><span class="operator">,</span><span class="variable">$seq</span><span class="operator">);</span>
   <span class="keyword">my</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="operator">(</span><span class="variable">$seq</span><span class="operator">=~</span> <span class="regex">s/</span><span class="variable">$regexp</span><span class="regex">/$1/eg</span><span class="operator">);</span>
   <span class="keyword">print</span> <span class="string">"Motif </span><span class="variable">$mid</span><span class="string"> is present </span><span class="variable">$count</span><span class="string"> times in this sequence\n"</span><span class="operator">;</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>ProtMatrix is designed to provide some basic methods when working with position scoring (weight) matrices related to protein sequences. A protein PSM consists of 20 vectors with 20 frequencies (one per amino acid per position). This is the minimum information you should provide to construct a PSM object. The vectors can be provided as strings with frequencies where the frequency is {0..a} and a=1. This is the way MEME compressed representation of a matrix and it is quite useful when working with relational DB. If arrays are provided as an input (references to arrays actually) they can be any number, real or integer (frequency or count).</p>

<p>When creating the object the constructor will check for positions that equal 0. If such is found it will increase the count for all positions by one and recalculate the frequency. Potential bug - if you are using frequencies and one of the positions is 0 it will change significantly. However, you should never have frequency that equals 0.</p>

<p>Throws an exception if: You mix as an input array and string (for example A matrix is given as array, C - as string). The position vector is (0,0,0,0). One of the probability vectors is shorter than the rest.</p>

<p>Summary of the methods I use most frequently (details bellow):</p>

<pre><code><code>   iupac - return IUPAC compliant consensus as a string
   score - Returns the score as a real number
   IC - information content. Returns a real number
   id - identifier. Returns a string
   accession - accession number. Returns a string
   next_pos - return the sequence probably for each letter, IUPAC
         symbol, IUPAC probability and simple sequence
   consenus letter for this position. Rewind at the end. Returns a hash.
   pos - current position get/set. Returns an integer.
   regexp - construct a regular expression based on IUPAC consensus.
         For example AGWV will be [Aa][Gg][AaTt][AaCcGg]
   width - site width
   get_string - gets the probability vector for a single base as a string.
   get_array - gets the probability vector for a single base as an array.
   get_logs_array - gets the log-odds vector for a single base as an array.</code></code></pre>

<p>New methods, which might be of interest to anyone who wants to store PSM in a relational database without creating an entry for each position is the ability to compress the PSM vector into a string with losing usually less than 1% of the data. this can be done with:</p>

<pre><code><code>   <span class="keyword">my</span> <span class="variable">$str</span><span class="operator">=</span><span class="variable">$matrix</span><span class="operator">-&gt;</span><span class="variable">get_compressed_freq</span><span class="operator">(</span><span class="string">'A'</span><span class="operator">);</span>
   <span class="keyword">or</span>
   
   <span class="keyword">my</span> <span class="variable">$str</span><span class="operator">=</span><span class="variable">$matrix</span><span class="operator">-&gt;</span><span class="variable">get_compressed_logs</span><span class="operator">(</span><span class="string">'A'</span><span class="operator">);</span>
</code></code></pre>

<p>Loading from a database should be done with new, but is not yet implemented. However you can still uncompress such string with:</p>

<pre><code><code>   <span class="keyword">my</span> <span class="variable">@arr</span><span class="operator">=</span><span class="variable">Bio::Matrix::PSM::_uncompress_string</span> <span class="operator">(</span><span class="variable">$str</span><span class="operator">,</span><span class="number">1</span><span class="operator">,</span><span class="number">1</span><span class="operator">);</span> <span class="keyword">for</span> <span class="variable">PSM</span>
</code></code></pre>

<p>or</p>

<pre><code><code>   <span class="keyword">my</span> <span class="variable">@arr</span><span class="operator">=</span><span class="variable">Bio::Matrix::PSM::_uncompress_string</span> <span class="operator">(</span><span class="variable">$str</span><span class="operator">,</span><span class="number">1000</span><span class="operator">,</span><span class="number">2</span><span class="operator">);</span> <span class="keyword">for</span> <span class="keyword">log</span> <span class="variable">odds</span>
</code></code></pre>

<h1 id="FEEDBACK">FEEDBACK</h1>

<h2 id="Mailing-Lists">Mailing Lists</h2>

<p>User feedback is an integral part of the evolution of this and other Bioperl modules. Send your comments and suggestions preferably to one of the Bioperl mailing lists. Your participation is much appreciated.</p>

<pre><code><code>  bioperl-l@bioperl.org                  - General discussion
  http://bioperl.org/wiki/Mailing_lists  - About the mailing lists</code></code></pre>

<h2 id="Support">Support</h2>

<p>Please direct usage questions or support issues to the mailing list:</p>

<p><i>bioperl-l@bioperl.org</i></p>

<p>rather than to the module maintainer directly. Many experienced and reponsive experts will be able look at the problem and quickly address it. Please include a thorough description of the problem with code and data examples if at all possible.</p>

<h2 id="Reporting-Bugs">Reporting Bugs</h2>

<p>Report bugs to the Bioperl bug tracking system to help us keep track the bugs and their resolution. Bug reports can be submitted via the web:</p>

<pre><code><code>  https://redmine.open-bio.org/projects/bioperl/</code></code></pre>

<h1 id="AUTHOR---James-Thompson">AUTHOR - James Thompson</h1>

<p>Email tex@biosysadmin.com</p>

<h1 id="APPENDIX">APPENDIX</h1>

<h2 id="new">new</h2>

<pre><code><code> <span class="variable">Title</span>    <span class="operator">:</span> <span class="variable">new</span>
 <span class="variable">Usage</span>    <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$site</span> <span class="operator">=</span> <span class="variable">Bio::Matrix::PSM::ProtMatrix</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span> 
               <span class="variable">%probs</span><span class="operator">,</span>
               <span class="variable">%logs</span><span class="operator">,</span>
               <span class="string">-IC</span>    <span class="operator">=&gt;</span> <span class="variable">$ic</span><span class="operator">,</span>
               <span class="string">-e_val</span> <span class="operator">=&gt;</span> <span class="variable">$score</span><span class="operator">,</span> 
               <span class="string">-id</span>    <span class="operator">=&gt;</span> <span class="variable">$mid</span>
               <span class="operator">-</span><span class="string">model</span> <span class="operator">=&gt;</span> <span class="operator">\</span><span class="variable">%model</span>
            <span class="operator">);</span>
 <span class="variable">Function</span> <span class="operator">:</span> <span class="variable">Creates</span> <span class="variable">a</span> <span class="variable">new</span> <span class="variable">Bio::Matrix::PSM::ProtMatrix</span> <span class="variable">object</span> <span class="variable">from</span> <span class="variable">memory</span>
 <span class="variable">Throws</span>   <span class="operator">:</span> <span class="variable">If</span> <span class="variable">inconsistent</span> <span class="variable">data</span> <span class="keyword">for</span> <span class="variable">all</span> <span class="variable">vectors</span> <span class="operator">(</span><span class="variable">all</span> <span class="number">20</span> <span class="variable">amino</span> <span class="variable">acids</span><span class="operator">)</span> <span class="variable">is</span>
               <span class="variable">provided</span><span class="operator">,</span> <span class="keyword">if</span> <span class="variable">you</span> <span class="variable">mix</span> <span class="variable">input</span> <span class="variable">types</span> <span class="operator">(</span><span class="variable">string</span> <span class="variable">vs</span> <span class="variable">array</span><span class="operator">)</span> <span class="keyword">or</span> <span class="keyword">if</span> <span class="variable">a</span>
               <span class="variable">position</span> <span class="variable">freq</span> <span class="variable">is</span> <span class="number">0</span><span class="operator">.</span>
 <span class="variable">Example</span>  <span class="operator">:</span>
 <span class="variable">Returns</span>  <span class="operator">:</span> <span class="variable">Bio::Matrix::PSM::ProtMatrix</span> <span class="variable">object</span>
 <span class="variable">Args</span>     <span class="operator">:</span> <span class="variable">Hash</span> <span class="variable">references</span> <span class="variable">to</span> <span class="keyword">log</span><span class="operator">-</span><span class="variable">odds</span> <span class="variable">scores</span> <span class="keyword">and</span> <span class="variable">probabilities</span> <span class="keyword">for</span>
            <span class="variable">position</span><span class="operator">-</span><span class="variable">specific</span> <span class="variable">scoring</span> <span class="variable">info</span><span class="operator">,</span> <span class="variable">e</span><span class="operator">-</span><span class="variable">value</span> <span class="operator">(</span><span class="variable">optional</span><span class="operator">),</span> <span class="variable">information</span>
            <span class="variable">content</span> <span class="operator">(</span><span class="variable">optional</span><span class="operator">),</span> <span class="variable">id</span> <span class="operator">(</span><span class="variable">optional</span><span class="operator">),</span> <span class="variable">model</span> <span class="keyword">for</span> <span class="variable">background</span> <span class="variable">distribution</span>
            <span class="variable">of</span> <span class="variable">proteins</span> <span class="operator">(</span><span class="variable">optional</span><span class="operator">).</span>
</code></code></pre>

<h2 id="alphabet">alphabet</h2>

<pre><code><code> Title    : Returns an array (or array reference if desired) to the alphabet 
 Usage    :
 Function : Returns an array (or array reference) containing all of the
            allowable characters for this matrix.
 Throws   :
 Example  :
 Returns  : Array or arrary reference.
 Args     :</code></code></pre>

<h2 id="calculate_consensus">_calculate_consensus</h2>

<pre><code><code> Title    : _calculate_consensus
 Usage    :
 Function : Calculates the consensus sequence for this matrix. 
 Throws   :
 Example  :
 Returns  :
 Args     :</code></code></pre>

<h2 id="next_pos">next_pos</h2>

<pre><code><code> Title    : next_pos
 Usage    :
 Function : Retrives the next position features: frequencies for all 20 amino
            acids, log-odds scores for all 20 amino acids at this position,
            the main (consensus) letter at this position, the probability
            for the consensus letter to occur at this position and the relative
            current position as an integer.
 Throws   :
 Example  :
 Returns  : hash (or hash reference) (pA,pR,pN,pD,...,logA,logR,logN,logD,aa,prob,rel)
            - pN entries represent the probability for amino acid N
            to be at this position
            - logN entries represent the log-odds score for having amino acid
            N at this position
            - aa is the consensus amino acid
            - prob is the probability for the consensus amino acid to be at this 
            position
            - rel is the relative index of the current position (integer)
 Args      : none</code></code></pre>

<h2 id="curpos">curpos</h2>

<pre><code><code> Title    : curpos
 Usage    :
 Function : Gets/sets the current position. 
 Throws   :
 Example  :
 Returns  : Current position (integer).
 Args     : New position (integer).</code></code></pre>

<h2 id="e_val">e_val</h2>

<pre><code><code> Title    : e_val
 Usage    :
 Function : Gets/sets the e-value
 Throws   :
 Example  :
 Returns  : 
 Args     : real number</code></code></pre>

<h2 id="IC">IC</h2>

<pre><code><code> Title    : IC
 Usage    :
 Function : Position-specific information content.
 Throws   :
 Example  :
 Returns  : Information content for current position.
 Args     : Information content for current position.</code></code></pre>

<h2 id="accession_number">accession_number</h2>

<pre><code><code> Title    : accession_number
 Usage    :
 Function: accession number, this will be unique id for the ProtMatrix object as
            well for any other object, inheriting from ProtMatrix.
 Throws   :
 Example  :
 Returns  : New accession number (string)
 Args     : Accession number (string)</code></code></pre>

<h2 id="consensus">consensus</h2>

<pre><code><code> Title    : consensus
 Usage    :
 Function : Returns the consensus sequence for this PSM.
 Throws   : if supplied with thresold outisde 5..10 range
 Example  :
 Returns  : string
 Args     : (optional) threshold value 5 to 10 (corresponds to 50-100% at each position</code></code></pre>

<h2 id="get_string">get_string</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">get_string</span>
 <span class="variable">Usage</span>   <span class="operator">:</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Returns</span> <span class="keyword">given</span> <span class="variable">probability</span> <span class="variable">vector</span> <span class="variable">as</span> <span class="variable">a</span> <span class="variable">string</span><span class="operator">.</span> <span class="variable">Useful</span> <span class="keyword">if</span> <span class="variable">you</span> <span class="variable">want</span> <span class="variable">to</span>
            <span class="variable">store</span> <span class="variable">things</span> <span class="variable">in</span> <span class="variable">a</span> <span class="variable">rel</span> <span class="variable">database</span><span class="operator">,</span> <span class="variable">where</span> <span class="variable">arrays</span> <span class="variable">are</span> <span class="keyword">not</span> <span class="variable">first</span> <span class="variable">choice</span>
 <span class="variable">Throws</span>  <span class="operator">:</span> <span class="variable">If</span> <span class="variable">the</span> <span class="variable">argument</span> <span class="variable">is</span> <span class="variable">outside</span> <span class="operator">{</span><span class="variable">A</span><span class="operator">,</span><span class="variable">C</span><span class="operator">,</span><span class="variable">G</span><span class="operator">,</span><span class="variable">T</span><span class="operator">}</span>
 <span class="variable">Example</span> <span class="operator">:</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">string</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">character</span> <span class="operator">{</span><span class="variable">A</span><span class="operator">,</span><span class="variable">C</span><span class="operator">,</span><span class="variable">G</span><span class="operator">,</span><span class="variable">T</span><span class="operator">}</span>
</code></code></pre>

<h2 id="width">width</h2>

<pre><code><code> Title    : width
 Usage    :
 Function : Returns the length of the site
 Throws   :
 Example  :
 Returns  : number
 Args     :</code></code></pre>

<h2 id="get_array">get_array</h2>

<pre><code><code> Title    : get_array
 Usage    :
 Function : Returns an array with frequencies for a specified amino acid.
 Throws   :
 Example  :
 Returns  : Array representing frequencies for specified amino acid.
 Args     : Single amino acid (character).</code></code></pre>

<h2 id="get_logs_array">get_logs_array</h2>

<pre><code><code> Title    : get_logs_array
 Usage    :
 Function : Returns an array with log_odds for a specified base
 Throws   :
 Example  :
 Returns  : Array representing log-odds scores for specified amino acid.
 Args     : Single amino acid (character).</code></code></pre>

<h2 id="id">id</h2>

<pre><code><code> Title    : id
 Usage    :
 Function : Gets/sets the site id
 Throws   :
 Example  :
 Returns  : string
 Args     : string</code></code></pre>

<h2 id="regexp">regexp</h2>

<pre><code><code> Title    : regexp
 Usage    :
 Function : Returns a case-insensitive regular expression which matches the
            IUPAC convention.  X&#39;s in consensus sequence will match anything.     
 Throws   :
 Example  :
 Returns  : string
 Args     : Threshold for calculating consensus sequence (number in range 0-100
            representing a percentage). Threshold defaults to 20.</code></code></pre>

<h2 id="regexp_array">regexp_array</h2>

<pre><code><code> Title    : regexp_array
 Usage    :
 Function : Returns an array of position-specific regular expressions.
             X&#39;s in consensus sequence will match anything.      
 Throws   :
 Example  :
 Returns  : Array of position-specific regular expressions.
 Args     : Threshold for calculating consensus sequence (number in range 0-100
            representing a percentage). Threshold defaults to 20.
 Notes    : Simply calls regexp method in list context.</code></code></pre>

<h2 id="compress_array">_compress_array</h2>

<pre><code><code> <span class="variable">Title</span>    <span class="operator">:</span> <span class="variable">_compress_array</span>
 <span class="variable">Usage</span>    <span class="operator">:</span>
 <span class="variable">Function</span> <span class="operator">:</span>  <span class="variable">Will</span> <span class="variable">compress</span> <span class="variable">an</span> <span class="variable">array</span> <span class="variable">of</span> <span class="variable">real</span> <span class="variable">signed</span> <span class="variable">numbers</span> <span class="variable">to</span> <span class="variable">a</span> <span class="variable">string</span> <span class="operator">(</span><span class="variable">ie</span> <span class="variable">vector</span> <span class="variable">of</span> <span class="variable">bytes</span><span class="operator">)</span>
             <span class="operator">-</span><span class="number">127</span> <span class="variable">to</span> <span class="operator">+</span><span class="number">127</span> <span class="keyword">for</span> <span class="variable">bi</span><span class="operator">-</span><span class="variable">directional</span><span class="operator">(</span><span class="variable">signed</span><span class="operator">)</span> <span class="keyword">and</span> <span class="number">0</span><span class="operator">..</span><span class="number">255</span> <span class="keyword">for</span> <span class="variable">unsigned</span> <span class="operator">;</span>
 <span class="variable">Throws</span>   <span class="operator">:</span>
 <span class="variable">Example</span>  <span class="operator">:</span>  <span class="variable">Internal</span> <span class="variable">stuff</span>
 <span class="variable">Returns</span>  <span class="operator">:</span>  <span class="variable">String</span>
 <span class="variable">Args</span>     <span class="operator">:</span>  <span class="variable">array</span> <span class="variable">reference</span><span class="operator">,</span> <span class="variable">followed</span> <span class="variable">by</span> <span class="variable">max</span> <span class="variable">value</span> <span class="keyword">and</span> <span class="variable">direction</span> <span class="operator">(</span><span class="variable">optional</span><span class="operator">,</span> <span class="variable">defaults</span> <span class="variable">to</span> <span class="number">1</span><span class="operator">),</span>
             <span class="variable">direction</span> <span class="variable">of</span> <span class="number">1</span> <span class="variable">is</span> <span class="variable">unsigned</span><span class="operator">,</span> <span class="variable">anything</span> <span class="keyword">else</span> <span class="variable">is</span> <span class="variable">signed</span><span class="operator">.</span> 
</code></code></pre>

<h2 id="uncompress_string">_uncompress_string</h2>

<pre><code><code> Title    : _uncompress_string
 Usage    :
 Function :   Will uncompress a string (vector of bytes) to create an array of real
                  signed numbers (opposite to_compress_array)
 Throws   :
 Example  :   Internal stuff
 Returns  :   string, followed by max value and direction (optional, defaults to 1),
              direction of 1 is unsigned, anything else is signed.
 Args     :   array</code></code></pre>

<h2 id="get_compressed_freq">get_compressed_freq</h2>

<pre><code><code> <span class="variable">Title</span>    <span class="operator">:</span> <span class="variable">get_compressed_freq</span>
 <span class="variable">Usage</span>    <span class="operator">:</span>
 <span class="variable">Function</span><span class="operator">:</span>   <span class="variable">A</span> <span class="variable">method</span> <span class="variable">to</span> <span class="variable">provide</span> <span class="variable">a</span> <span class="variable">compressed</span> <span class="variable">frequency</span> <span class="variable">vector</span><span class="operator">.</span> <span class="variable">It</span> <span class="variable">uses</span> <span class="variable">one</span> <span class="variable">byte</span> <span class="variable">to</span>
             <span class="variable">code</span> <span class="variable">the</span> <span class="variable">frequence</span> <span class="keyword">for</span> <span class="variable">one</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">probability</span> <span class="variable">vectors</span> <span class="keyword">for</span> <span class="variable">one</span> <span class="variable">position</span><span class="operator">.</span>
             <span class="variable">Useful</span> <span class="keyword">for</span> <span class="variable">relational</span> <span class="variable">database</span><span class="operator">.</span> <span class="variable">Improvment</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">previous</span> <span class="number">0</span><span class="operator">..</span><span class="variable">a</span> <span class="variable">coding</span><span class="operator">.</span>
 <span class="variable">Throws</span>   <span class="operator">:</span>
 <span class="variable">Example</span>  <span class="operator">:</span>   <span class="keyword">my</span> <span class="variable">$strA</span><span class="operator">=</span><span class="variable">$self</span><span class="operator">-&gt;</span><span class="variable">get_compressed_freq</span><span class="operator">(</span><span class="string">'A'</span><span class="operator">);</span>
 <span class="variable">Returns</span>  <span class="operator">:</span>   <span class="variable">String</span>
 <span class="variable">Args</span>     <span class="operator">:</span>   <span class="variable">char</span> 
</code></code></pre>

<h2 id="sequence_match_weight">sequence_match_weight</h2>

<pre><code><code> <span class="variable">Title</span>    <span class="operator">:</span> <span class="variable">sequence_match_weight</span>
 <span class="variable">Usage</span>    <span class="operator">:</span>
 <span class="variable">Function</span> <span class="operator">:</span>   <span class="variable">This</span> <span class="variable">method</span> <span class="variable">will</span> <span class="variable">calculate</span> <span class="variable">the</span> <span class="variable">score</span> <span class="variable">of</span> <span class="variable">a</span> <span class="variable">match</span><span class="operator">,</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">the</span> <span class="variable">PSM</span>
              <span class="keyword">if</span> <span class="variable">such</span> <span class="variable">is</span> <span class="variable">associated</span> <span class="variable">with</span> <span class="variable">the</span> <span class="variable">matrix</span> <span class="variable">object</span><span class="operator">.</span> <span class="variable">Returns</span> <span class="keyword">undef</span> <span class="keyword">if</span> <span class="keyword">no</span>
              <span class="variable">PSM</span> <span class="variable">data</span> <span class="variable">is</span> <span class="variable">available</span><span class="operator">.</span>
 <span class="variable">Throws</span>   <span class="operator">:</span>   <span class="keyword">if</span> <span class="variable">the</span> <span class="keyword">length</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequence</span> <span class="variable">is</span> <span class="variable">different</span> <span class="variable">from</span> <span class="variable">the</span> <span class="variable">matrix</span> <span class="variable">width</span>
 <span class="variable">Example</span>  <span class="operator">:</span>   <span class="keyword">my</span> <span class="variable">$score</span><span class="operator">=</span><span class="variable">$matrix</span><span class="operator">-&gt;</span><span class="variable">sequence_match_weight</span><span class="operator">(</span><span class="string">'ACGGATAG'</span><span class="operator">);</span>
 <span class="variable">Returns</span>  <span class="operator">:</span>   <span class="variable">Floating</span> <span class="variable">point</span>
 <span class="variable">Args</span>     <span class="operator">:</span>   <span class="variable">string</span>
</code></code></pre>

<h2 id="to_IUPAC">_to_IUPAC</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_to_IUPAC</span>
 <span class="variable">Usage</span>   <span class="operator">:</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Converts</span> <span class="variable">a</span> <span class="variable">single</span> <span class="variable">position</span> <span class="variable">to</span> <span class="variable">IUPAC</span> <span class="variable">compliant</span> <span class="variable">symbol</span> <span class="keyword">and</span> <span class="variable">returns</span> <span class="variable">its</span> <span class="variable">probability</span><span class="operator">.</span>
            <span class="variable">Currently</span> <span class="variable">returns</span> <span class="variable">the</span> <span class="variable">most</span> <span class="variable">likely</span> <span class="variable">amino</span> <span class="variable">acid</span><span class="operator">/</span><span class="variable">probability</span> <span class="variable">combination</span><span class="operator">.</span>
 <span class="variable">Throws</span>  <span class="operator">:</span>
 <span class="variable">Example</span> <span class="operator">:</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">char</span><span class="operator">,</span> <span class="variable">real</span> <span class="variable">number</span> <span class="variable">representing</span> <span class="variable">an</span> <span class="variable">amino</span> <span class="variable">acid</span> <span class="keyword">and</span> <span class="variable">a</span> <span class="variable">probability</span><span class="operator">.</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">real</span> <span class="variable">numbers</span> <span class="keyword">for</span> <span class="variable">all</span> <span class="number">20</span> <span class="variable">amino</span> <span class="variable">acids</span> <span class="operator">(</span><span class="variable">ordered</span> <span class="variable">by</span> <span class="variable">alphabet</span> <span class="variable">contained</span>
            <span class="variable">in</span> <span class="variable">$self</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">_alphabet</span><span class="operator">}</span><span class="operator">,</span> <span class="variable">minimum</span> <span class="variable">probability</span> <span class="variable">threshold</span><span class="operator">.</span>
</code></code></pre>

<h2 id="to_cons">_to_cons</h2>

<pre><code><code> Title   : _to_cons
 Usage   :
 Function: Converts a single position to simple consensus character and returns
            its probability. Currently just calls the _to_IUPAC subroutine. 
 Throws  :
 Example :
 Returns : char, real number
 Args    : real numbers for A,C,G,T (positional)</code></code></pre>

<h2 id="get_all_vectors">get_all_vectors</h2>

<pre><code><code> <span class="variable">Title</span>    <span class="operator">:</span> <span class="variable">get_all_vectors</span>
 <span class="variable">Usage</span>    <span class="operator">:</span>
 <span class="variable">Function</span> <span class="operator">:</span>  <span class="variable">returns</span> <span class="variable">all</span> <span class="variable">possible</span> <span class="variable">sequence</span> <span class="variable">vectors</span> <span class="variable">to</span> <span class="variable">satisfy</span> <span class="variable">the</span> <span class="variable">PFM</span> <span class="variable">under</span>
             <span class="variable">a</span> <span class="keyword">given</span> <span class="variable">threshold</span>
 <span class="variable">Throws</span>   <span class="operator">:</span>  <span class="variable">If</span> <span class="variable">threshold</span> <span class="variable">outside</span> <span class="variable">of</span> <span class="number">0</span><span class="operator">..</span><span class="number">1</span> <span class="operator">(</span><span class="keyword">no</span> <span class="variable">sense</span> <span class="variable">to</span> <span class="keyword">do</span> <span class="variable">that</span><span class="operator">)</span>
 <span class="variable">Example</span>  <span class="operator">:</span>  <span class="keyword">my</span> <span class="variable">@vectors</span> <span class="operator">=</span> <span class="variable">$self</span><span class="operator">-&gt;</span><span class="variable">get_all_vectors</span><span class="operator">(</span><span class="number">4</span><span class="operator">);</span>
 <span class="variable">Returns</span>  <span class="operator">:</span>  <span class="variable">Array</span> <span class="variable">of</span> <span class="variable">strings</span>
 <span class="variable">Args</span>     <span class="operator">:</span>  <span class="operator">(</span><span class="variable">optional</span><span class="operator">)</span> <span class="variable">floating</span>
</code></code></pre>


</body>

</html>


