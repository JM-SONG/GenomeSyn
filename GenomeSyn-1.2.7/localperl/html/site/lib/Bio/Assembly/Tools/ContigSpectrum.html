<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a>
    <ul>
      <li><a href="#Background">Background</a></li>
      <li><a href="#Implementation">Implementation</a></li>
    </ul>
  </li>
  <li><a href="#FEEDBACK">FEEDBACK</a>
    <ul>
      <li><a href="#Mailing-Lists">Mailing Lists</a></li>
      <li><a href="#Support">Support</a></li>
      <li><a href="#Reporting-Bugs">Reporting Bugs</a></li>
    </ul>
  </li>
  <li><a href="#AUTHOR---Florent-E-Angly">AUTHOR - Florent E Angly</a></li>
  <li><a href="#APPENDIX">APPENDIX</a>
    <ul>
      <li><a href="#new">new</a></li>
      <li><a href="#id">id</a></li>
      <li><a href="#nof_seq">nof_seq</a></li>
      <li><a href="#nof_rep">nof_rep</a></li>
      <li><a href="#max_size">max_size</a></li>
      <li><a href="#nof_overlaps">nof_overlaps</a></li>
      <li><a href="#min_overlap">min_overlap</a></li>
      <li><a href="#avg_overlap">avg_overlap</a></li>
      <li><a href="#min_identity">min_identity</a></li>
      <li><a href="#avg_identity">avg_identity</a></li>
      <li><a href="#avg_seq_len">avg_seq_len</a></li>
      <li><a href="#eff_asm_params">eff_asm_params</a></li>
      <li><a href="#spectrum">spectrum</a></li>
      <li><a href="#assembly">assembly</a></li>
      <li><a href="#drop_assembly">drop_assembly</a></li>
      <li><a href="#dissolve">dissolve</a></li>
      <li><a href="#cross">cross</a></li>
      <li><a href="#to_string">to_string</a></li>
      <li><a href="#add">add</a></li>
      <li><a href="#average">average</a></li>
      <li><a href="#score">score</a></li>
      <li><a href="#naive_assembler">_naive_assembler</a></li>
      <li><a href="#create_subcontig">_create_subcontig</a></li>
      <li><a href="#obj_copy">_obj_copy</a></li>
      <li><a href="#new_from_assembly">_new_from_assembly</a></li>
      <li><a href="#new_dissolved_csp">_new_dissolved_csp</a></li>
      <li><a href="#dissolve_contig">_dissolve_contig</a></li>
      <li><a href="#new_cross_csp">_new_cross_csp</a></li>
      <li><a href="#cross_contig">_cross_contig</a></li>
      <li><a href="#seq_origin">_seq_origin</a></li>
      <li><a href="#import_assembly">_import_assembly</a></li>
      <li><a href="#import_spectrum">_import_spectrum</a></li>
      <li><a href="#import_dissolved_csp">_import_dissolved_csp</a></li>
      <li><a href="#import_cross_csp">_import_cross_csp</a></li>
      <li><a href="#get_contig_like">_get_contig_like</a></li>
      <li><a href="#get_assembly_seq_stats">_get_assembly_seq_stats</a></li>
      <li><a href="#get_contig_seq_stats">_get_contig_seq_stats</a></li>
      <li><a href="#update_seq_stats">_update_seq_stats</a></li>
      <li><a href="#get_assembly_overlap_stats">_get_assembly_overlap_stats</a></li>
      <li><a href="#get_contig_overlap_stats">_get_contig_overlap_stats</a></li>
      <li><a href="#update_overlap_stats">_update_overlap_stats</a></li>
      <li><a href="#overlap_alignment">_overlap_alignment</a></li>
      <li><a href="#contig_graph">_contig_graph</a></li>
      <li><a href="#draw_graph">_draw_graph</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Bio::Assembly::Tools::ContigSpectrum - create and manipulate contig spectra</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>  <span class="comment"># Simple contig spectrum creation</span>
  <span class="keyword">my</span> <span class="variable">$csp1</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
    <span class="string">-id</span>       <span class="operator">=&gt;</span> <span class="string">'csp1'</span><span class="operator">,</span>
    <span class="string">-spectrum</span> <span class="operator">=&gt;</span> <span class="operator">{</span> <span class="number">1</span> <span class="operator">=&gt;</span> <span class="number">10</span><span class="operator">,</span>
                   <span class="number">2</span> <span class="operator">=&gt;</span> <span class="number">2</span><span class="operator">,</span>
                   <span class="number">3</span> <span class="operator">=&gt;</span> <span class="number">1</span> <span class="operator">}</span> <span class="operator">);</span>
  
  <span class="comment"># ...or another way to create a simple contig spectrum</span>
  <span class="keyword">my</span> <span class="variable">$csp2</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">;</span>
  <span class="variable">$csp2</span><span class="operator">-&gt;</span><span class="variable">id</span><span class="operator">(</span><span class="string">'csp2'</span><span class="operator">);</span>
  <span class="variable">$csp2</span><span class="operator">-&gt;</span><span class="variable">spectrum</span><span class="operator">(</span><span class="operator">{</span> <span class="number">1</span> <span class="operator">=&gt;</span> <span class="number">20</span><span class="operator">,</span> <span class="number">2</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">,</span> <span class="number">4</span> <span class="operator">=&gt;</span> <span class="number">1</span> <span class="operator">}</span><span class="operator">);</span>
  
  <span class="comment"># Get some information</span>
  <span class="keyword">print</span> <span class="string">"This is contig spectrum "</span><span class="operator">.</span><span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">id</span><span class="operator">.</span><span class="string">"\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="string">"It contains "</span><span class="operator">.</span><span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">nof_seq</span><span class="operator">.</span><span class="string">" sequences\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="string">"The largest contig has "</span><span class="operator">.</span><span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">max_size</span><span class="operator">.</span><span class="string">" sequences\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="string">"The spectrum is: "</span><span class="operator">.</span><span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">(</span><span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">spectrum</span><span class="operator">).</span><span class="string">"\n"</span><span class="operator">;</span>
  
  <span class="comment"># Let's add the contig spectra</span>
  <span class="keyword">my</span> <span class="variable">$summed_csp</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">;</span>
  <span class="variable">$summed_csp</span><span class="operator">-&gt;</span><span class="variable">add</span><span class="operator">(</span><span class="variable">$csp1</span><span class="operator">);</span>
  <span class="variable">$summed_csp</span><span class="operator">-&gt;</span><span class="variable">add</span><span class="operator">(</span><span class="variable">$csp2</span><span class="operator">);</span>
  <span class="keyword">print</span> <span class="string">"The summed contig spectrum is "</span><span class="operator">.</span><span class="variable">$summed_csp</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">.</span><span class="string">"\n"</span><span class="operator">;</span>
  
  <span class="comment"># Make an average</span>
  <span class="keyword">my</span> <span class="variable">$avg_csp</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">;</span>
  <span class="variable">$avg_csp</span> <span class="operator">=</span> <span class="variable">$avg_csp</span><span class="operator">-&gt;</span><span class="variable">average</span><span class="operator">(</span><span class="operator">[</span><span class="variable">$csp1</span><span class="operator">,</span> <span class="variable">$csp2</span><span class="operator">]</span><span class="operator">);</span>
  <span class="keyword">print</span> <span class="string">"The average contig spectrum is "</span><span class="operator">.</span><span class="variable">$avg_csp</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">.</span><span class="string">"\n"</span><span class="operator">;</span>
  
  <span class="comment"># Get a contig spectrum from an assembly</span>
  <span class="keyword">my</span> <span class="variable">$from_assembly</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
    <span class="string">-assembly</span>       <span class="operator">=&gt;</span> <span class="variable">$assembly_object</span><span class="operator">,</span>
    <span class="string">-eff_asm_params</span> <span class="operator">=&gt;</span> <span class="number">1</span><span class="operator">);</span>
  <span class="keyword">print</span> <span class="string">"The contig spectrum from assembly is "</span><span class="operator">.</span><span class="variable">$from_assembly</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">.</span><span class="string">"\n"</span><span class="operator">;</span>
  
  <span class="comment"># Report advanced information (possible because eff_asm_params = 1)</span>
  <span class="keyword">print</span> <span class="string">"Average sequence length: "</span><span class="operator">.</span><span class="variable">$from_assembly</span><span class="operator">-&gt;</span><span class="variable">avg_seq_len</span><span class="operator">.</span><span class="string">" bp\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="string">"Minimum overlap length: "</span><span class="operator">.</span><span class="variable">$from_assembly</span><span class="operator">-&gt;</span><span class="variable">min_overlap</span><span class="operator">.</span><span class="string">" bp\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="string">"Average overlap length: "</span><span class="operator">.</span><span class="variable">$from_assembly</span><span class="operator">-&gt;</span><span class="variable">avg_overlap</span><span class="operator">.</span><span class="string">" bp\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="string">"Minimum overlap match: "</span><span class="operator">.</span><span class="variable">$from_assembly</span><span class="operator">-&gt;</span><span class="variable">min_identity</span><span class="operator">.</span><span class="string">" %\n"</span><span class="operator">;</span>
  <span class="keyword">print</span> <span class="string">"Average overlap match: "</span><span class="operator">.</span><span class="variable">$from_assembly</span><span class="operator">-&gt;</span><span class="variable">avg_identity</span><span class="operator">.</span><span class="string">" %\n"</span><span class="operator">;</span>
  
  <span class="comment"># Assuming the assembly object contains sequences from several different</span>
  <span class="comment"># metagenomes, we have a mixed contig spectrum from which a cross contig</span>
  <span class="comment"># spectrum and dissolved contig spectra can be obtained</span>
  <span class="keyword">my</span> <span class="variable">$mixed_csp</span> <span class="operator">=</span> <span class="variable">$from_assembly</span><span class="operator">;</span>
  
  <span class="comment"># Calculate a dissolved contig spectrum</span>
  <span class="keyword">my</span> <span class="variable">$meta1_dissolved</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
    <span class="string">-dissolve</span> <span class="operator">=&gt;</span> <span class="operator">[</span><span class="variable">$mixed_csp</span><span class="operator">,</span> <span class="string">'metagenome1'</span><span class="operator">]</span> <span class="operator">);</span>
  <span class="keyword">my</span> <span class="variable">$meta2_dissolved</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
    <span class="string">-dissolve</span> <span class="operator">=&gt;</span> <span class="operator">[</span><span class="variable">$mixed_csp</span><span class="operator">,</span> <span class="string">'metagenome2'</span><span class="operator">]</span> <span class="operator">);</span>
  <span class="keyword">print</span> <span class="string">"The dissolved contig spectra are:\n"</span><span class="operator">.</span>
    <span class="variable">$meta1_dissolved</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">.</span><span class="string">"\n"</span><span class="operator">.</span>
    <span class="variable">$meta2_dissolved</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">.</span><span class="string">"\n"</span><span class="operator">;</span>
  
  <span class="comment"># Determine a cross contig spectrum</span>
  <span class="keyword">my</span> <span class="variable">$cross_csp</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
    <span class="string">-cross</span> <span class="operator">=&gt;</span> <span class="variable">$mixed_csp</span> <span class="operator">);</span>
  <span class="keyword">print</span> <span class="string">"The cross contig spectrum is "</span><span class="operator">.</span><span class="variable">$cross_csp</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">.</span><span class="string">"\n"</span><span class="operator">;</span>
  
  <span class="comment"># Score a contig spectrum (the more abundant the contigs and the larger their</span>
  <span class="comment"># size, the larger the score)</span>
  <span class="keyword">my</span> <span class="variable">$csp_score</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">score</span><span class="operator">(</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">nof_seq</span> <span class="operator">);</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>The Bio::Assembly::Tools::ContigSpectrum Perl module enables to manually create contig spectra, import them from assemblies, manipulate them, transform between different types of contig spectra and output them.</p>

<p>Bio::Assembly::Tools::ContigSpectrum is a module to create, manipulate and output contig spectra, assembly-derived data used in metagenomics (community genomics) for diversity estimation.</p>

<h2 id="Background">Background</h2>

<p>A contig spectrum is the count of the number of contigs of different size in an assembly. For example, the contig spectrum [100 5 1 0 0 ...] means that there were 100 singlets (1-contigs), 5 contigs of 2 sequences (2-contigs), 1 contig of 3 sequences (3-contig) and no larger contigs.</p>

<p>An assembly can be produced from a mixture of sequences from different metagenomes. The contig obtained from this assembly is a mixed contig spectrum. The contribution of each metagenome in this mixed contig spectrum can be obtained by determining a dissolved contig spectrum.</p>

<p>Finally, based on a mixed contig spectrum, a cross contig spectrum can be determined. In a cross contig spectrum, only contigs containing sequences from different metagenomes are kept; &quot;pure&quot; contigs are excluded. Additionally, the total number of singletons (1-contigs) from each region that assembles with any fragments from other regions is the number of 1-contigs in the cross contig spectrum.</p>

<h2 id="Implementation">Implementation</h2>

<p>The simplest representation of a contig spectrum is as a hash representation where the key is the contig size (number of sequences making up the contig) and the value the number of contigs of this size.</p>

<p>In fact, it is useful to have more information associated with the contig spectrum, hence the Bio::Assembly::Tools::ContigSpectrum module implements an object containing a contig spectrum hash and additional information. The get/set methods to access them are:</p>

<pre><code><code>    id              contig spectrum ID
    nof_rep         number of repetitions (assemblies) used
    max_size        size of (number of sequences in) the largest contig
    spectrum        hash representation of a contig spectrum

    nof_seq         number of sequences
    avg_seq_len     average sequence length

    eff_asm_params  reports effective assembly parameters

    nof_overlaps    number of overlaps (needs eff_asm_params)
    min_overlap     minimum overlap length in a contig (needs eff_asm_params)
    min_identity    minimum sequence identity percentage (needs eff_asm_params)
    avg_overlap     average overlap length (needs eff_asm_params)
    avg_identity    average overlap identity percentage (needs eff_asm_params)

  Operations on the contig spectra:

    to_string       create a string representation of the spectrum
    spectrum        import a hash contig spectrum
    assembly        determine a contig spectrum from an assembly, contig or singlet
    dissolve        calculate a dissolved contig spectrum (depends on assembly)
    cross           produce a cross contig spectrum (depends on assembly)
    add             add a contig spectrum to an existing one
    average         make an average of several contig spectra
    score           score a contig spectrum: the higher the number of contigs
                      and the larger their size, the higher the score.</code></code></pre>

<p>When using operations that rely on knowing &quot;where&quot; (from what metagenomes) a sequence came from (i.e. when creating a dissolved or cross contig spectrum), make sure that the sequences used for the assembly have a name header, e.g. &gt;metagenome1|seq1, &gt;metagenome2|seq1, ...</p>

<h1 id="FEEDBACK">FEEDBACK</h1>

<h2 id="Mailing-Lists">Mailing Lists</h2>

<p>User feedback is an integral part of the evolution of this and other Bioperl modules. Send your comments and suggestions preferably to the Bioperl mailing lists Your participation is much appreciated.</p>

<pre><code><code>  bioperl-l@bioperl.org                  - General discussion
  http://bioperl.org/wiki/Mailing_lists  - About the mailing lists</code></code></pre>

<h2 id="Support">Support</h2>

<p>Please direct usage questions or support issues to the mailing list:</p>

<p><i>bioperl-l@bioperl.org</i></p>

<p>rather than to the module maintainer directly. Many experienced and reponsive experts will be able look at the problem and quickly address it. Please include a thorough description of the problem with code and data examples if at all possible.</p>

<h2 id="Reporting-Bugs">Reporting Bugs</h2>

<p>Report bugs to the BioPerl bug tracking system to help us keep track the bugs and their resolution. Bug reports can be submitted via email or the web:</p>

<pre><code><code>  bioperl-bugs@bio.perl.org
  https://redmine.open-bio.org/projects/bioperl/</code></code></pre>

<h1 id="AUTHOR---Florent-E-Angly">AUTHOR - Florent E Angly</h1>

<p>Email florent_dot_angly_at_gmail_dot_com</p>

<h1 id="APPENDIX">APPENDIX</h1>

<p>The rest of the documentation details each of the object methods. Internal methods are usually preceded with a &quot;_&quot;.</p>

<h2 id="new">new</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">new</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$csp</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">();</span>
              <span class="keyword">or</span>
            <span class="keyword">my</span> <span class="variable">$csp</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
              <span class="string">-id</span> <span class="operator">=&gt;</span> <span class="string">'some_name'</span><span class="operator">,</span>
              <span class="string">-spectrum</span> <span class="operator">=&gt;</span>  <span class="operator">{</span> <span class="number">1</span> <span class="operator">=&gt;</span> <span class="number">90</span> <span class="operator">,</span> <span class="number">2</span> <span class="operator">=&gt;</span> <span class="number">3</span> <span class="operator">,</span> <span class="number">4</span> <span class="operator">=&gt;</span> <span class="number">1</span> <span class="operator">}</span><span class="operator">,</span>
            <span class="operator">);</span>
              <span class="keyword">or</span>
            <span class="keyword">my</span> <span class="variable">$csp</span> <span class="operator">=</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
              <span class="string">-assembly</span> <span class="operator">=&gt;</span>  <span class="variable">$assembly_obj</span>
            <span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">create</span> <span class="variable">a</span> <span class="variable">new</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">reference</span> <span class="variable">to</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">none</span>
</code></code></pre>

<h2 id="id">id</h2>

<pre><code><code>  Title   : id
  Usage   : $csp-&gt;id
  Function: get/set contig spectrum id
  Returns : string
  Args    : string [optional]</code></code></pre>

<h2 id="nof_seq">nof_seq</h2>

<pre><code><code>  Title   : nof_seq
  Usage   : $csp-&gt;nof_seq
  Function: get/set the number of sequences making up the contig spectrum
  Returns : integer
  Args    : integer [optional]</code></code></pre>

<h2 id="nof_rep">nof_rep</h2>

<pre><code><code>  Title   : nof_rep
  Usage   : $csp-&gt;nof_rep
  Function: Get/Set the number of repetitions (assemblies) used to create the 
            contig spectrum
  Returns : integer
  Args    : integer [optional]</code></code></pre>

<h2 id="max_size">max_size</h2>

<pre><code><code>  Title   : max_size
  Usage   : $csp-&gt;max_size
  Function: get/set the size of (number of sequences in) the largest contig
  Returns : integer
  Args    : integer [optional]</code></code></pre>

<h2 id="nof_overlaps">nof_overlaps</h2>

<pre><code><code>  Title   : nof_overlaps
  Usage   : $csp-&gt;nof_overlaps
  Function: Get/Set the number of overlaps in the assembly.
  Returns : integer
  Args    : integer [optional]</code></code></pre>

<h2 id="min_overlap">min_overlap</h2>

<pre><code><code>  Title   : min_overlap
  Usage   : $csp-&gt;min_overlap
  Function: get/set the assembly minimum overlap length
  Returns : integer
  Args    : integer [optional]</code></code></pre>

<h2 id="avg_overlap">avg_overlap</h2>

<pre><code><code>  Title   : avg_overlap
  Usage   : $csp-&gt;avg_overlap
  Function: get/set the assembly average overlap length
  Returns : decimal
  Args    : decimal [optional]</code></code></pre>

<h2 id="min_identity">min_identity</h2>

<pre><code><code>  Title   : min_identity
  Usage   : $csp-&gt;min_identity
  Function: get/set the assembly minimum overlap identity percent
  Returns : 0 &lt; decimal &lt; 100
  Args    : 0 &lt; decimal &lt; 100 [optional]</code></code></pre>

<h2 id="avg_identity">avg_identity</h2>

<pre><code><code>  Title   : avg_identity
  Usage   : $csp-&gt;avg_identity
  Function: get/set the assembly average overlap identity percent
  Returns : 0 &lt; decimal &lt; 100
  Args    : 0 &lt; decimal &lt; 100 [optional]</code></code></pre>

<h2 id="avg_seq_len">avg_seq_len</h2>

<pre><code><code>  Title   : avg_seq_len
  Usage   : $csp-&gt;avg_seq_len
  Function: get/set the assembly average sequence length
  Returns : avg_seq_len
  Args    : real [optional]</code></code></pre>

<h2 id="eff_asm_params">eff_asm_params</h2>

<pre><code><code>  Title   : eff_asm_params
  Usage   : $csp-&gt;eff_asm_params(1)
  Function: Get/set the effective assembly parameters option. It defines if the
            effective assembly parameters should be determined when a contig
            spectrum based or derived from an assembly is calculated. The
            effective assembly parameters include avg_seq_length, nof_overlaps,
            min_overlap, avg_overlap, min_identity and avg_identity.
            1 = get them, 0 = don&#39;t.
  Returns : integer
  Args    : integer [optional]</code></code></pre>

<h2 id="spectrum">spectrum</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">spectrum</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$spectrum</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">spectrum</span><span class="operator">(</span><span class="operator">{</span><span class="number">1</span><span class="operator">=&gt;</span><span class="number">10</span><span class="operator">,</span> <span class="number">2</span><span class="operator">=&gt;</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">=&gt;</span><span class="number">1</span><span class="operator">}</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">the</span> <span class="variable">current</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">represented</span> <span class="variable">as</span> <span class="variable">a</span> <span class="variable">hash</span> <span class="operator">/</span> <span class="variable">Update</span> <span class="variable">a</span>
            <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">represented</span> <span class="variable">as</span> <span class="variable">a</span>
            <span class="variable">hash</span>
            <span class="variable">The</span> <span class="variable">hash</span> <span class="variable">representation</span> <span class="variable">of</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">is</span> <span class="variable">as</span> <span class="variable">following</span><span class="operator">:</span>
              <span class="variable">key</span>   <span class="operator">-&gt;</span> <span class="variable">contig</span> <span class="variable">size</span> <span class="operator">(</span><span class="variable">in</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sequences</span><span class="operator">)</span>
              <span class="variable">value</span> <span class="operator">-&gt;</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">contigs</span> <span class="variable">of</span> <span class="variable">this</span> <span class="variable">size</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">as</span> <span class="variable">a</span> <span class="variable">hash</span> <span class="variable">reference</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">as</span> <span class="variable">a</span> <span class="variable">hash</span> <span class="variable">reference</span> <span class="operator">[</span><span class="variable">optional</span><span class="operator">]</span>
</code></code></pre>

<h2 id="assembly">assembly</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">assembly</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">@obj_list</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">assembly</span><span class="operator">();</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">get</span><span class="operator">/</span><span class="variable">set</span> <span class="variable">the</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span> <span class="variable">by</span> <span class="variable">adding</span> <span class="variable">an</span> <span class="variable">assembly</span><span class="operator">,</span> <span class="variable">contig</span> <span class="keyword">or</span>
            <span class="variable">singlet</span> <span class="variable">object</span> <span class="variable">to</span> <span class="variable">it</span><span class="operator">,</span> <span class="keyword">or</span> <span class="variable">get</span> <span class="variable">the</span> <span class="variable">list</span> <span class="variable">of</span> <span class="variable">objects</span> <span class="variable">associated</span> <span class="variable">with</span> <span class="variable">it</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">arrayref</span> <span class="variable">of</span> <span class="variable">assembly</span><span class="operator">,</span> <span class="variable">contig</span> <span class="keyword">and</span> <span class="variable">singlet</span> <span class="variable">objects</span> <span class="variable">used</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">contig</span>
            <span class="variable">spectrum</span> <span class="variable">object</span> <span class="operator">(</span><span class="variable">Bio::Assembly::Scaffold</span><span class="operator">,</span> <span class="variable">Bio::Assembly::Contig</span> <span class="keyword">and</span>
            <span class="variable">Bio::Assembly::Singlet</span> <span class="variable">objects</span><span class="operator">)</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Scaffold</span><span class="operator">,</span> <span class="variable">Contig</span> <span class="keyword">or</span> <span class="variable">Singlet</span> <span class="variable">object</span>
</code></code></pre>

<h2 id="drop_assembly">drop_assembly</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">drop_assembly</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">drop_assembly</span><span class="operator">();</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Remove</span> <span class="variable">all</span> <span class="variable">assembly</span> <span class="variable">objects</span> <span class="variable">associated</span> <span class="variable">with</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span><span class="operator">.</span>
            <span class="variable">Assembly</span> <span class="variable">objects</span> <span class="variable">can</span> <span class="variable">take</span> <span class="variable">a</span> <span class="variable">lot</span> <span class="variable">of</span> <span class="variable">memory</span><span class="operator">,</span> <span class="variable">which</span> <span class="variable">can</span> <span class="variable">be</span> <span class="variable">freed</span> <span class="variable">by</span>
            <span class="variable">calling</span> <span class="variable">this</span> <span class="variable">method</span><span class="operator">.</span> <span class="variable">Don't</span> <span class="variable">call</span> <span class="variable">this</span> <span class="variable">method</span> <span class="keyword">if</span> <span class="variable">you</span> <span class="variable">need</span> <span class="variable">the</span> <span class="variable">assembly</span>
            <span class="variable">object</span> <span class="variable">later</span> <span class="variable">on</span><span class="operator">,</span> <span class="keyword">for</span> <span class="variable">example</span> <span class="keyword">for</span> <span class="variable">creating</span> <span class="variable">a</span> <span class="variable">dissolved</span> <span class="keyword">or</span> <span class="variable">cross</span>
            <span class="variable">contig</span> <span class="variable">spectrum</span><span class="operator">.</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="keyword">for</span> <span class="variable">success</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">none</span>
</code></code></pre>

<h2 id="dissolve">dissolve</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">dissolve</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$dissolved_csp</span><span class="operator">-&gt;</span><span class="variable">dissolve</span><span class="operator">(</span><span class="variable">$mixed_csp</span><span class="operator">,</span> <span class="variable">$seq_header</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Dissolve</span> <span class="variable">a</span> <span class="variable">mixed</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">set</span> <span class="variable">of</span> <span class="variable">sequences</span> <span class="variable">that</span>
            <span class="variable">contain</span> <span class="variable">the</span> <span class="variable">specified</span> <span class="variable">header</span><span class="operator">,</span> <span class="variable">i</span><span class="operator">.</span><span class="variable">e</span><span class="operator">.</span> <span class="variable">determine</span> <span class="variable">the</span> <span class="variable">contribution</span> <span class="variable">of</span>
            <span class="variable">these</span> <span class="variable">sequences</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">mixed</span> <span class="variable">contig</span> <span class="variable">spectrum</span><span class="operator">.</span> <span class="variable">The</span> <span class="variable">mixed</span> <span class="variable">contig</span>
            <span class="variable">spectrum</span> <span class="variable">object</span> <span class="variable">must</span> <span class="variable">have</span> <span class="variable">one</span> <span class="keyword">or</span> <span class="variable">several</span> <span class="variable">assembly</span> <span class="variable">object</span><span class="operator">(</span><span class="regex">s). In
            addition, min_overlap, min_identity and eff_asm_params are taken
            from the mixed contig spectrum, unless they are specified manually
            for the dissolved contig spectrum. The dissolved contigs underlying
            the contig spectrum can be obtained by calling the assembly() method.
  Returns : 1 for success
  Args    : Bio::Assembly::Tools::ContigSpectrum reference
            sequence header string
  </span>
</code></code></pre>

<h2 id="cross">cross</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">cross</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$cross_csp</span><span class="operator">-&gt;</span><span class="variable">cross</span><span class="operator">(</span><span class="variable">$mixed_csp</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Calculate</span> <span class="variable">a</span> <span class="variable">cross</span> <span class="variable">contig_spectrum</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">a</span> <span class="variable">mixed</span> <span class="variable">contig_spectrum</span><span class="operator">.</span>
            <span class="variable">The</span> <span class="variable">underlying</span> <span class="variable">cross</span><span class="operator">-</span><span class="variable">contigs</span> <span class="variable">themselves</span> <span class="variable">can</span> <span class="variable">be</span> <span class="variable">obtained</span> <span class="variable">by</span> <span class="variable">calling</span> 
            <span class="variable">the</span> <span class="variable">assembly</span><span class="operator">()</span> <span class="variable">method</span><span class="operator">.</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="keyword">for</span> <span class="variable">success</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span> <span class="variable">reference</span>
</code></code></pre>

<h2 id="to_string">to_string</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">to_string</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$csp_string</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">to_string</span><span class="operator">;</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Convert</span> <span class="variable">the</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">into</span> <span class="variable">a</span> <span class="variable">string</span> <span class="operator">(</span><span class="variable">easy</span> <span class="variable">to</span> <span class="keyword">print</span><span class="operator">!!).</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">string</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">element</span> <span class="variable">separator</span> <span class="operator">(</span><span class="variable">integer</span><span class="operator">)</span> <span class="operator">[</span><span class="variable">optional</span><span class="operator">]</span>
              <span class="number">1</span> <span class="operator">-&gt;</span> <span class="variable">space</span><span class="operator">-</span><span class="variable">separated</span>
              <span class="number">2</span> <span class="operator">-&gt;</span> <span class="variable">tab</span><span class="operator">-</span><span class="variable">separated</span>
              <span class="number">3</span> <span class="operator">-&gt;</span> <span class="variable">newline</span><span class="operator">-</span><span class="variable">separated</span>
</code></code></pre>

<h2 id="add">add</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">add</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">add</span><span class="operator">(</span><span class="variable">$additional_csp</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Add</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">to</span> <span class="variable">an</span> <span class="variable">existing</span> <span class="variable">one</span><span class="operator">:</span> <span class="variable">sums</span> <span class="variable">the</span> <span class="variable">spectra</span><span class="operator">,</span> <span class="variable">update</span>
            <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sequences</span><span class="operator">,</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">repetitions</span><span class="operator">,</span> <span class="operator">...</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="keyword">for</span> <span class="variable">success</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span> <span class="variable">object</span>
</code></code></pre>

<h2 id="average">average</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">average</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$avg_csp</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">average</span><span class="operator">(</span><span class="operator">[</span><span class="variable">$csp1</span><span class="operator">,</span> <span class="variable">$csp2</span><span class="operator">,</span> <span class="variable">$csp3</span><span class="operator">]</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Average</span> <span class="variable">one</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="keyword">or</span> <span class="variable">the</span> <span class="variable">sum</span> <span class="variable">of</span> <span class="variable">several</span> <span class="variable">contig</span> <span class="variable">spectra</span> <span class="variable">by</span>
            <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">repetitions</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span> <span class="variable">array</span> <span class="variable">reference</span>
            <span class="variable">eff_asm_params</span>
</code></code></pre>

<h2 id="score">score</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">score</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$score</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">score</span><span class="operator">();</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Score</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="operator">(</span><span class="keyword">or</span> <span class="variable">cross</span><span class="operator">-</span><span class="variable">contig</span> <span class="variable">spectrum</span><span class="operator">)</span> <span class="variable">such</span> <span class="variable">that</span> <span class="variable">the</span>
             <span class="variable">higher</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">contigs</span> <span class="operator">(</span><span class="keyword">or</span> <span class="variable">cross</span><span class="operator">-</span><span class="variable">contigs</span><span class="operator">)</span> <span class="keyword">and</span> <span class="variable">the</span> <span class="variable">larger</span> <span class="variable">their</span> 
             <span class="variable">size</span><span class="operator">,</span> <span class="variable">the</span> <span class="variable">higher</span> <span class="variable">the</span> <span class="variable">score</span><span class="operator">.</span>
             <span class="variable">Let</span> <span class="variable">n</span>   <span class="operator">:</span> <span class="variable">total</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sequences</span>
                 <span class="variable">c_q</span> <span class="operator">:</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">contigs</span> <span class="variable">of</span> <span class="variable">size</span> <span class="string">q
                 q   : number of seq</span><span class="variable">uence</span> <span class="variable">in</span> <span class="variable">a</span> <span class="variable">contig</span>
             <span class="variable">We</span> <span class="variable">define</span><span class="operator">:</span> <span class="variable">score</span> <span class="operator">=</span> <span class="variable">n</span><span class="operator">/(</span><span class="variable">n</span><span class="operator">-</span><span class="number">1</span><span class="operator">)</span> <span class="operator">*</span> <span class="operator">(</span><span class="variable">X</span> <span class="operator">-</span> <span class="number">1</span><span class="operator">/</span><span class="variable">n</span><span class="operator">)</span>
                  <span class="variable">where</span> <span class="variable">X</span> <span class="operator">=</span> <span class="variable">sum</span> <span class="operator">(</span> <span class="variable">c_q</span> <span class="operator">*</span> <span class="string">q^2 ) / n**2
             The score ranges from 0 (singlets only) to 1 (a single large contig)
             It is possible to specify a value for the number of sequences to
              assume in the contig spectrum.
  Returns : contig score, or undef if there were no sequences in the contig spectrum
  Args    : number of total sequences to assume [optional]
  </span>
</code></code></pre>

<h2 id="naive_assembler">_naive_assembler</h2>

<pre><code><code>  Title   : _naive_assembler
  Usage   : 
  Function: Reassemble the specified sequences only based on their position in
            the contig. This naive assembly only verifies that the minimum
            overlap length and percentage identity are respected. No actual
            alignment is done
  Returns : arrayref of contigs and singlets
  Args    : Bio::Assembly::Contig
            array reference of sequence IDs to use [optional]
            minimum overlap length (integer)       [optional]
            minimum percentage identity (integer)  [optional]</code></code></pre>

<h2 id="create_subcontig">_create_subcontig</h2>

<pre><code><code>  Title   : _create_subcontig
  Usage   : 
  Function: Create a subcontig from another contig
  Returns : Bio::Assembly::Contig object
  Args    : Bio::Assembly::Contig
            arrayref of the IDs of the reads to includes in the subcontig
            ID to give to the subcontig</code></code></pre>

<h2 id="obj_copy">_obj_copy</h2>

<pre><code><code>  Title   : _obj_copy
  Usage   : 
  Function: Copy (most of) an object, and optionally truncate it
  Returns : another a Bio::LocatableSeq, Bio::Seq::PrimaryQual, or
              Bio::SeqFeature::Generic object
  Args    : a Bio::LocatableSeq, Bio::Seq::PrimaryQual, or
              Bio::SeqFeature::Generic object
            a start position
            an end position</code></code></pre>

<h2 id="new_from_assembly">_new_from_assembly</h2>

<pre><code><code>  Title   : _new_from_assembly
  Usage   : 
  Function: Creates a new contig spectrum object based solely on the result of 
            an assembly, contig or singlet
  Returns : Bio::Assembly::Tools::ContigSpectrum object
  Args    : Bio::Assembly::Scaffold, Contig or Singlet object</code></code></pre>

<h2 id="new_dissolved_csp">_new_dissolved_csp</h2>

<pre><code><code>  Title   : _new_dissolved_csp
  Usage   : 
  Function: create a dissolved contig spectrum object
  Returns : dissolved contig spectrum
  Args    : mixed contig spectrum
            header of sequences to keep in this contig spectrum</code></code></pre>

<h2 id="dissolve_contig">_dissolve_contig</h2>

<pre><code><code>  Title   : _dissolve_contig
  Usage   : 
  Function: dissolve a contig
  Returns : arrayref of contigs and singlets
  Args    : mixed contig spectrum
            header of sequences to keep in this contig spectrum
            minimum overlap
            minimum identity</code></code></pre>

<h2 id="new_cross_csp">_new_cross_csp</h2>

<pre><code><code>  Title   : _new_cross_csp
  Usage   : 
  Function: create a cross contig spectrum object
  Returns : cross-contig spectrum
  Args    : mixed contig spectrum</code></code></pre>

<h2 id="cross_contig">_cross_contig</h2>

<pre><code><code>  Title   : _cross_contig
  Usage   : 
  Function: calculate cross contigs
  Returns : arrayref of cross-contigs
            number of cross-singlets
  Args    : contig
            minimum overlap
            minimum identity</code></code></pre>

<h2 id="seq_origin">_seq_origin</h2>

<pre><code><code>  Title   : _seq_origin
  Usage   : 
  Function: determines where a sequence comes from using its header. For example
            the origin of the sequence &#39;metagenome1|gi|9626988|ref|NC_001508.1|&#39;
            is &#39;metagenome1&#39;
  Returns : origin
  Args    : sequence ID</code></code></pre>

<h2 id="import_assembly">_import_assembly</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_import_assembly</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_import_assembly</span><span class="operator">(</span><span class="variable">$assemblyobj</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Update</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">an</span> <span class="variable">assembly</span><span class="operator">,</span> <span class="variable">contig</span> <span class="keyword">or</span>
            <span class="variable">singlet</span> <span class="variable">object</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="keyword">for</span> <span class="variable">success</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Scaffold</span><span class="operator">,</span> <span class="variable">Contig</span> <span class="keyword">or</span> <span class="variable">Singlet</span> <span class="variable">object</span>
</code></code></pre>

<h2 id="import_spectrum">_import_spectrum</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_import_spectrum</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_import_spectrum</span><span class="operator">(</span><span class="operator">{</span> <span class="number">1</span> <span class="operator">=&gt;</span> <span class="number">90</span> <span class="operator">,</span> <span class="number">2</span> <span class="operator">=&gt;</span> <span class="number">3</span> <span class="operator">,</span> <span class="number">4</span> <span class="operator">=&gt;</span> <span class="number">1</span> <span class="operator">}</span><span class="operator">)</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">update</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span>
            <span class="variable">represented</span> <span class="variable">as</span> <span class="variable">a</span> <span class="variable">hash</span> <span class="operator">(</span><span class="variable">key</span><span class="operator">:</span> <span class="variable">contig</span> <span class="variable">size</span><span class="operator">,</span> <span class="variable">value</span><span class="operator">:</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">contigs</span> <span class="variable">of</span>
            <span class="variable">this</span> <span class="variable">size</span><span class="operator">)</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="keyword">for</span> <span class="variable">success</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">as</span> <span class="variable">a</span> <span class="variable">hash</span> <span class="variable">reference</span>
</code></code></pre>

<h2 id="import_dissolved_csp">_import_dissolved_csp</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_import_dissolved_csp</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_import_dissolved_csp</span><span class="operator">(</span><span class="variable">$mixed_csp</span><span class="operator">,</span> <span class="variable">$seq_header</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Update</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span> <span class="variable">by</span> <span class="variable">dissolving</span> <span class="variable">a</span> <span class="variable">mixed</span> <span class="variable">contig</span>
            <span class="variable">spectrum</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">the</span> <span class="variable">header</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequences</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="keyword">for</span> <span class="variable">success</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span>
            <span class="variable">sequence</span> <span class="variable">header</span> <span class="variable">string</span>
</code></code></pre>

<h2 id="import_cross_csp">_import_cross_csp</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_import_cross_csp</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_import_cross_csp</span><span class="operator">(</span><span class="variable">$mixed_csp</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Update</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="variable">spectrum</span> <span class="variable">object</span> <span class="variable">by</span> <span class="variable">calculating</span> <span class="variable">the</span> <span class="variable">cross</span> <span class="variable">contig</span>
            <span class="variable">spectrum</span> <span class="variable">based</span> <span class="variable">on</span> <span class="variable">a</span> <span class="variable">mixed</span> <span class="variable">contig</span> <span class="variable">spectrum</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="number">1</span> <span class="keyword">for</span> <span class="variable">success</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Tools::ContigSpectrum</span>
</code></code></pre>

<h2 id="get_contig_like">_get_contig_like</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_get_contig_like</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">@contig_like_objs</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_get_contig_like</span><span class="operator">(</span><span class="variable">$assembly_obj</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">contigs</span> <span class="keyword">and</span> <span class="variable">singlets</span> <span class="variable">from</span> <span class="variable">an</span> <span class="variable">assembly</span><span class="operator">,</span> <span class="variable">contig</span> <span class="keyword">or</span> <span class="variable">singlet</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">array</span> <span class="variable">of</span> <span class="variable">Bio::Assembly::Contig</span> <span class="keyword">and</span> <span class="variable">Singlet</span> <span class="variable">objects</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">a</span> <span class="variable">Bio::Assembly::Scaffold</span><span class="operator">,</span> <span class="variable">Contig</span> <span class="keyword">or</span> <span class="variable">singlet</span> <span class="variable">object</span>
</code></code></pre>

<h2 id="get_assembly_seq_stats">_get_assembly_seq_stats</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_get_assembly_seq_stats</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$seqlength</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_get_assembly_seq_stats</span><span class="operator">(</span><span class="variable">$assemblyobj</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">sequence</span> <span class="variable">statistics</span> <span class="variable">from</span> <span class="variable">an</span> <span class="variable">assembly</span><span class="operator">:</span>
              <span class="variable">average</span> <span class="variable">sequence</span> <span class="keyword">length</span><span class="operator">,</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sequences</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">average</span> <span class="variable">sequence</span> <span class="keyword">length</span> <span class="operator">(</span><span class="variable">decimal</span><span class="operator">)</span>
            <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sequences</span> <span class="operator">(</span><span class="variable">integer</span><span class="operator">)</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Scaffold</span><span class="operator">,</span> <span class="variable">Contig</span> <span class="keyword">or</span> <span class="variable">singlet</span> <span class="variable">object</span>
            <span class="variable">hash</span> <span class="variable">reference</span> <span class="variable">with</span> <span class="variable">the</span> <span class="variable">IDs</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequences</span> <span class="variable">to</span> <span class="variable">consider</span> <span class="operator">[</span><span class="variable">optional</span><span class="operator">]</span>
</code></code></pre>

<h2 id="get_contig_seq_stats">_get_contig_seq_stats</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_get_contig_seq_stats</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="variable">$seqlength</span> <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_get_contig_seq_stats</span><span class="operator">(</span><span class="variable">$contigobj</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">sequence</span> <span class="variable">statistics</span> <span class="variable">from</span> <span class="variable">a</span> <span class="variable">contig</span><span class="operator">:</span>
              <span class="variable">average</span> <span class="variable">sequence</span> <span class="keyword">length</span><span class="operator">,</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sequences</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">average</span> <span class="variable">sequence</span> <span class="keyword">length</span> <span class="operator">(</span><span class="variable">decimal</span><span class="operator">)</span>
            <span class="variable">number</span> <span class="variable">of</span> <span class="variable">sequences</span> <span class="operator">(</span><span class="variable">integer</span><span class="operator">)</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">contig</span> <span class="variable">object</span> <span class="variable">reference</span>
            <span class="variable">hash</span> <span class="variable">reference</span> <span class="variable">with</span> <span class="variable">the</span> <span class="variable">IDs</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequences</span> <span class="variable">to</span> <span class="variable">consider</span> <span class="operator">[</span><span class="variable">optional</span><span class="operator">]</span>
</code></code></pre>

<h2 id="update_seq_stats">_update_seq_stats</h2>

<pre><code><code>  Title   : _update_seq_stats
  Usage   : 
  Function: Update the number of sequences and their average length 1
            average identity 1
            minimum length 1
            minimum identity 1
            number of overlaps 1 average sequence length
  Returns : average sequence length
            number of sequences
  Args    : average sequence length 1
            number of sequences 1
            average sequence length 2
            number of sequences 2           </code></code></pre>

<h2 id="get_assembly_overlap_stats">_get_assembly_overlap_stats</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_get_assembly_overlap_stats</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$avglength</span><span class="operator">,</span> <span class="variable">$avgidentity</span><span class="operator">,</span> <span class="variable">$minlength</span><span class="operator">,</span> <span class="variable">$min_identity</span><span class="operator">,</span> <span class="variable">$nof_overlaps</span><span class="operator">)</span>
              <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_get_assembly_overlap_stats</span><span class="operator">(</span><span class="variable">$assemblyobj</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">statistics</span> <span class="variable">about</span> <span class="variable">pairwise</span> <span class="variable">overlaps</span> <span class="variable">in</span> <span class="variable">contigs</span> <span class="variable">of</span> <span class="variable">an</span> <span class="variable">assembly</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">average</span> <span class="variable">overlap</span> <span class="keyword">length</span>
            <span class="variable">average</span> <span class="variable">identity</span> <span class="variable">percent</span>
            <span class="variable">minimum</span> <span class="variable">overlap</span> <span class="keyword">length</span>
            <span class="variable">minimum</span> <span class="variable">identity</span> <span class="variable">percent</span>
            <span class="variable">number</span> <span class="variable">of</span> <span class="variable">overlaps</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Scaffold</span><span class="operator">,</span> <span class="variable">Contig</span> <span class="keyword">or</span> <span class="variable">Singlet</span> <span class="variable">object</span>
            <span class="variable">hash</span> <span class="variable">reference</span> <span class="variable">with</span> <span class="variable">the</span> <span class="variable">IDs</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequences</span> <span class="variable">to</span> <span class="variable">consider</span> <span class="operator">[</span><span class="variable">optional</span><span class="operator">]</span>
</code></code></pre>

<h2 id="get_contig_overlap_stats">_get_contig_overlap_stats</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">_get_contig_overlap_stats</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$avglength</span><span class="operator">,</span> <span class="variable">$avgidentity</span><span class="operator">,</span> <span class="variable">$minlength</span><span class="operator">,</span> <span class="variable">$min_identity</span><span class="operator">,</span> <span class="variable">$nof_overlaps</span><span class="operator">)</span>
              <span class="operator">=</span> <span class="variable">$csp</span><span class="operator">-&gt;</span><span class="variable">_get_contig_overlap_stats</span><span class="operator">(</span><span class="variable">$contigobj</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Get</span> <span class="variable">statistics</span> <span class="variable">about</span> <span class="variable">pairwise</span> <span class="variable">overlaps</span> <span class="variable">in</span> <span class="variable">a</span> <span class="variable">contig</span> <span class="keyword">or</span> <span class="variable">singlet</span><span class="operator">.</span> <span class="variable">The</span>
              <span class="variable">statistics</span> <span class="variable">are</span> <span class="variable">obtained</span> <span class="variable">using</span> <span class="variable">graph</span> <span class="variable">theory</span><span class="operator">:</span> <span class="keyword">each</span> <span class="keyword">read</span> <span class="variable">is</span> <span class="variable">a</span> <span class="variable">node</span>
              <span class="keyword">and</span> <span class="variable">the</span> <span class="variable">edges</span> <span class="variable">between</span> <span class="number">2</span> <span class="variable">reads</span> <span class="variable">are</span> <span class="variable">weighted</span> <span class="variable">by</span> <span class="variable">minus</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span>
              <span class="variable">conserved</span> <span class="variable">residues</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">alignment</span> <span class="variable">between</span> <span class="variable">the</span> <span class="number">2</span> <span class="variable">reads</span><span class="operator">.</span> <span class="variable">The</span>
              <span class="variable">minimum</span> <span class="variable">spanning</span> <span class="variable">tree</span> <span class="variable">of</span> <span class="variable">this</span> <span class="variable">graph</span> <span class="variable">represents</span> <span class="variable">the</span> <span class="variable">overlaps</span> <span class="variable">that</span>
              <span class="variable">form</span> <span class="variable">the</span> <span class="variable">contig</span><span class="operator">.</span> <span class="variable">Overlaps</span> <span class="variable">that</span> <span class="keyword">do</span> <span class="keyword">not</span> <span class="variable">satisfy</span> <span class="variable">the</span> <span class="variable">minimum</span> <span class="variable">overlap</span>
              <span class="keyword">length</span> <span class="keyword">and</span> <span class="variable">similarity</span> <span class="variable">get</span> <span class="variable">a</span> <span class="variable">malus</span> <span class="variable">on</span> <span class="variable">their</span> <span class="variable">score</span><span class="operator">.</span>
              <span class="variable">Note</span><span class="operator">:</span> <span class="variable">This</span> <span class="variable">function</span> <span class="variable">requires</span> <span class="variable">the</span> <span class="variable">optional</span> <span class="variable">BioPerl</span> <span class="variable">dependency</span>
              <span class="variable">module</span> <span class="variable">called</span> <span class="string">'Graph'</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">average</span> <span class="variable">overlap</span> <span class="keyword">length</span>
            <span class="variable">average</span> <span class="variable">identity</span> <span class="variable">percent</span>
            <span class="variable">minimum</span> <span class="variable">overlap</span> <span class="keyword">length</span>
            <span class="variable">minimum</span> <span class="variable">identity</span> <span class="variable">percent</span>
            <span class="variable">number</span> <span class="variable">of</span> <span class="variable">overlaps</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">Bio::Assembly::Contig</span> <span class="keyword">or</span> <span class="variable">Singlet</span> <span class="variable">object</span>
            <span class="variable">hash</span> <span class="variable">reference</span> <span class="variable">with</span> <span class="variable">the</span> <span class="variable">IDs</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequences</span> <span class="variable">to</span> <span class="variable">consider</span> <span class="operator">[</span><span class="variable">optional</span><span class="operator">]</span>
</code></code></pre>

<h2 id="update_overlap_stats">_update_overlap_stats</h2>

<pre><code><code>  Title   : _update_overlap_stats
  Usage   : 
  Function: update the number of overlaps and their minimum and average length
            and identity
  Returns : 
  Args    : average length 1
            average identity 1
            minimum length 1
            minimum identity 1
            number of overlaps 1
            average length 2
            average identity 2
            minimum length 2
            minimum identity 2
            number of overlaps 2</code></code></pre>

<h2 id="overlap_alignment">_overlap_alignment</h2>

<pre><code><code>  Title   : _overlap_alignment
  Usage   : 
  Function: Produce an alignment of the overlapping section of two sequences of
            a contig. Minimum overlap length and percentage identity can be
            specified. Return undef if the sequences do not overlap or do not
            meet the minimum overlap criteria.
  Return  : Bio::SimpleAlign object reference
            alignment overlap length
            alignment overlap identity
  Args    : Bio::Assembly::Contig object reference
            Bio::LocatableSeq contig sequence 1
            Bio::LocatableSeq contig sequence 2
            minium overlap length [optional]
            minimum overlap identity percentage[optional]</code></code></pre>

<h2 id="contig_graph">_contig_graph</h2>

<pre><code><code>  Title   : _contig_graph
  Usage   : 
  Function: Creates a graph data structure of the contig.The graph is undirected.
            The vertices are the reads of the contig and edges are the overlap
            between the reads. The edges are weighted by the opposite of the
            overlap, so it is negative and the better the overlap, the lower the
            weight.
  Return  : Graph object or undef
            hashref of overlaps (score, length, identity) for each read pair
  Args    : Bio::Assembly::Contig object reference
            hash reference with the IDs of the sequences to consider [optional]
            minimum overlap length (integer)                         [optional]
            minimum percentage identity (integer)                    [optional]</code></code></pre>

<h2 id="draw_graph">_draw_graph</h2>

<pre><code><code>  Title   : _draw_graph
  Usage   : 
  Function: Generates a PNG picture of the contig graph. It is mostly for
            debugging purposes.
  Return  : 1 for success
  Args    : a Graph object
            hashref of overlaps (score, length, identity) for each read pair
            name of output file
            overlap info to display: &#39;score&#39; (default), &#39;length&#39; or &#39;identity&#39;</code></code></pre>


</body>

</html>


