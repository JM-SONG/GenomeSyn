<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../../displayToc.js"></script>
<script language="JavaScript" src="../../../../tocParas.js"></script>
<script language="JavaScript" src="../../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a>
    <ul>
      <li><a href="#Differences-from-Bio::Seq::SeqWithQuality">Differences from Bio::Seq::SeqWithQuality</a></li>
    </ul>
  </li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#FEEDBACK">FEEDBACK</a>
    <ul>
      <li><a href="#Mailing-Lists">Mailing Lists</a></li>
      <li><a href="#Support">Support</a></li>
      <li><a href="#Reporting-Bugs">Reporting Bugs</a></li>
    </ul>
  </li>
  <li><a href="#AUTHOR---Heikki-Lehvaslaiho">AUTHOR - Heikki Lehvaslaiho</a></li>
  <li><a href="#CONTRIBUTORS">CONTRIBUTORS</a></li>
  <li><a href="#APPENDIX">APPENDIX</a>
    <ul>
      <li><a href="#new">new</a></li>
      <li><a href="#qual">qual</a></li>
      <li><a href="#qual_text">qual_text</a></li>
      <li><a href="#subqual">subqual</a></li>
      <li><a href="#subqual_text">subqual_text</a></li>
      <li><a href="#quality_length">quality_length</a></li>
      <li><a href="#quality_is_flush">quality_is_flush</a></li>
      <li><a href="#trace">trace</a></li>
      <li><a href="#trace_text">trace_text</a></li>
      <li><a href="#subtrace">subtrace</a></li>
      <li><a href="#subtrace_text">subtrace_text</a></li>
      <li><a href="#trace_length">trace_length</a></li>
      <li><a href="#trace_is_flush">trace_is_flush</a></li>
      <li><a href="#get_trace_graph">get_trace_graph</a></li>
      <li><a href="#threshold">threshold</a></li>
      <li><a href="#mask_below_threshold">mask_below_threshold</a></li>
      <li><a href="#count_clear_ranges">count_clear_ranges</a></li>
      <li><a href="#clear_ranges_length">clear_ranges_length</a></li>
      <li><a href="#get_clear_range">get_clear_range</a></li>
      <li><a href="#get_all_clean_ranges">get_all_clean_ranges</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Bio::Seq::Quality - Implementation of sequence with residue quality and trace values</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Bio::Seq::Quality</span><span class="operator">;</span>
  
  <span class="comment"># input can be space delimited string or array ref</span>
  <span class="keyword">my</span> <span class="variable">$qual</span> <span class="operator">=</span> <span class="string">'0 1 2 3 4 5 6 7 8 9 11 12'</span><span class="operator">;</span>
  <span class="keyword">my</span> <span class="variable">$trace</span> <span class="operator">=</span> <span class="string">'0 5 10 15 20 25 30 35 40 45 50 55'</span><span class="operator">;</span>
  
  <span class="keyword">my</span> <span class="variable">$seq</span> <span class="operator">=</span> <span class="variable">Bio::Seq::Quality</span><span class="operator">-&gt;</span><span class="variable">new</span>
      <span class="operator">(</span> <span class="string">-qual</span> <span class="operator">=&gt;</span> <span class="variable">$qual</span><span class="operator">,</span>
        <span class="string">-trace_indices</span> <span class="operator">=&gt;</span> <span class="variable">$trace</span><span class="operator">,</span>
        <span class="string">-seq</span> <span class="operator">=&gt;</span>  <span class="string">'atcgatcgatcg'</span><span class="operator">,</span>
        <span class="string">-id</span>  <span class="operator">=&gt;</span> <span class="string">'human_id'</span><span class="operator">,</span>
        <span class="string">-accession_number</span> <span class="operator">=&gt;</span> <span class="string">'S000012'</span><span class="operator">,</span>
        <span class="string">-verbose</span> <span class="operator">=&gt;</span> <span class="operator">-</span><span class="number">1</span>   <span class="comment"># to silence deprecated methods</span>
  <span class="operator">);</span>
  
  <span class="keyword">my</span> <span class="variable">$quals</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">qual</span><span class="operator">;</span> <span class="comment"># array ref</span>
  <span class="keyword">my</span> <span class="variable">$traces</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">trace</span><span class="operator">;</span>  <span class="comment"># array ref</span>
  
  <span class="keyword">my</span> <span class="variable">$quals</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">qual_text</span><span class="operator">;</span> <span class="comment"># string</span>
  <span class="keyword">my</span> <span class="variable">$traces</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">trace_text</span><span class="operator">;</span> <span class="comment"># string</span>
  
  
  <span class="comment"># get sub values</span>
  <span class="variable">$quals</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">subqual</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">);</span>  <span class="comment"># array ref</span>
  <span class="variable">$traces</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">subtrace</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">);</span> <span class="comment"># array ref</span>
  <span class="variable">$quals</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">subqual_text</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">);</span> <span class="comment"># string</span>
  <span class="variable">$quals</span> <span class="operator">=</span> <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">subtrace_text</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">);</span> <span class="comment"># string</span>
  
  <span class="comment"># set sub values </span>
  <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">subqual</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="string">"9 9"</span><span class="operator">);</span>
  <span class="variable">$seq</span><span class="operator">-&gt;</span><span class="variable">subtrace</span><span class="operator">(</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="string">"9 9"</span><span class="operator">);</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This object stores base quality values together with the sequence string.</p>

<p>It is a reimplementation of Chad Matsalla&#39;s Bio::Seq::SeqWithQuality module using Bio::Seq::MetaI.</p>

<p>The implementation is based on Bio::Seq::Meta::Array. qual() and trace() are base methods to store and retrieve information that have extensions to retrieve values as a scalar (e.g. qual_text() ), or get or set subvalues (e.g. subqual() ). See <a href="../../../../../.cpan/build/BioPerl-1.6.901-ghKY8U/blib/lib/Bio/Seq/MetaI.html">Bio::Seq::MetaI</a> for more details.</p>

<p>All the functional code is in Bio::Seq::Meta::Array.</p>

<p>There deprecated methods that are included for compatibility with Bio::Seq::SeqWithQuality. These will print a warning unless verbosity of the object is set to be less than zero.</p>

<h2 id="Differences-from-Bio::Seq::SeqWithQuality">Differences from Bio::Seq::SeqWithQuality</h2>

<p>It is not possible to fully follow the interface of Bio::Seq::SeqWithQuality since internally a Bio::Seq::SeqWithQuality object is a composite of two independent objects: a Bio::PrimarySeq object and Bio::Seq::PrimaryQual object. Both of these objects can be created separately and merged into Bio::Seq::SeqWithQuality.</p>

<p>This implementation is based on Bio::Seq::Meta::Array that is a subclass of Bio::PrimarySeq that stores any number of meta information in unnamed arrays.</p>

<p>Here we assume that two meta sets, called &#39;qual&#39; and &#39;trace_indices&#39; are attached to a sequence. (But there is nothing that prevents you to add as many named meta sets as you need using normal meta() methods).</p>

<p>qual() is an alias to meta(), qualat($loc) is an alias to submeta($loc,$loc).</p>

<p>trace_indices() in Bio::Seq::SeqWithQuality has been abbreviated to trace() and is an alias to named_meta(&#39;trace&#39;).</p>

<p>You can create an object without passing any arguments to the constructor (Bio::Seq::SeqWithQuality fails without alphabet). It will warn about not being able to set alphabet unless you set verbosity of the object to a negative value.</p>

<p>After the latest rewrite, the meta information sets (quality and trace) no longer cover all the residues automatically. Methods to check the length of meta information (<a>quality_length</a>, <a>trace_length</a>)and to see if the ends are flushed to the sequence have been added (<a>quality_is_flush</a>, <a>trace_is_flush</a>). To force the old functinality, set <a>force_flush</a> to true.</p>

<p>qual_obj() and seq_obj() methods do not exist!</p>

<p>Finally, there is only one set of descriptors (primary_id, display_id, accession_number) for the object.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a href="../../../../../.cpan/build/BioPerl-1.6.901-ghKY8U/blib/lib/Bio/Seq/MetaI.html">Bio::Seq::MetaI</a>, <a href="../../../../../.cpan/build/BioPerl-1.6.901-ghKY8U/blib/lib/Bio/Seq/Meta/Array.html">Bio::Seq::Meta::Array</a></p>

<h1 id="FEEDBACK">FEEDBACK</h1>

<h2 id="Mailing-Lists">Mailing Lists</h2>

<p>User feedback is an integral part of the evolution of this and other Bioperl modules. Send your comments and suggestions preferably to one of the Bioperl mailing lists. Your participation is much appreciated.</p>

<pre><code><code>  bioperl-l@bioperl.org                  - General discussion
  http://bioperl.org/wiki/Mailing_lists  - About the mailing lists</code></code></pre>

<h2 id="Support">Support</h2>

<p>Please direct usage questions or support issues to the mailing list:</p>

<p><i>bioperl-l@bioperl.org</i></p>

<p>rather than to the module maintainer directly. Many experienced and reponsive experts will be able look at the problem and quickly address it. Please include a thorough description of the problem with code and data examples if at all possible.</p>

<h2 id="Reporting-Bugs">Reporting Bugs</h2>

<p>Report bugs to the Bioperl bug tracking system to help us keep track the bugs and their resolution. Bug reports can be submitted via the web:</p>

<pre><code><code>  https://redmine.open-bio.org/projects/bioperl/</code></code></pre>

<h1 id="AUTHOR---Heikki-Lehvaslaiho">AUTHOR - Heikki Lehvaslaiho</h1>

<p>Email heikki-at-bioperl-dot-org</p>

<h1 id="CONTRIBUTORS">CONTRIBUTORS</h1>

<p>Chad Matsalla, bioinformatics at dieselwurks dot com</p>

<p>Dan Bolser, dan dot bolser at gmail dot com</p>

<h1 id="APPENDIX">APPENDIX</h1>

<p>The rest of the documentation details each of the object methods. Internal methods are usually preceded with a _</p>

<h2 id="new">new</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">new</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$metaseq</span> <span class="operator">=</span> <span class="variable">Bio::Seq::Quality</span><span class="operator">-&gt;</span><span class="variable">new</span>
                <span class="operator">(</span> <span class="string">-qual</span> <span class="operator">=&gt;</span> <span class="string">'0 1 2 3 4 5 6 7 8 9 11 12'</span><span class="operator">,</span>
                  <span class="string">-trace</span> <span class="operator">=&gt;</span> <span class="string">'0 5 10 15 20 25 30 35 40 45 50 55'</span><span class="operator">,</span>
                  <span class="string">-seq</span> <span class="operator">=&gt;</span>  <span class="string">'atcgatcgatcg'</span><span class="operator">,</span>
                  <span class="string">-id</span>  <span class="operator">=&gt;</span> <span class="string">'human_id'</span><span class="operator">,</span>
                  <span class="string">-accession_number</span> <span class="operator">=&gt;</span> <span class="string">'S000012'</span><span class="operator">,</span>
                <span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Constructor</span> <span class="keyword">for</span> <span class="variable">Bio::Seq::Quality</span> <span class="variable">class</span><span class="operator">.</span>  <span class="variable">Note</span> <span class="variable">that</span> <span class="variable">you</span> <span class="variable">can</span>
           <span class="variable">provide</span> <span class="variable">an</span> <span class="variable">empty</span> <span class="variable">quality</span> <span class="keyword">and</span> <span class="variable">trace</span> <span class="variable">strings</span><span class="operator">.</span>
 
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">a</span> <span class="variable">new</span> <span class="variable">Bio::Seq::Quality</span> <span class="variable">object</span>
</code></code></pre>

<h2 id="qual">qual</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">qual</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$qual_values</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">qual</span><span class="operator">(</span><span class="variable">$values_string</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span>
 
           <span class="variable">Get</span> <span class="keyword">and</span> <span class="variable">set</span> <span class="variable">method</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">meta</span> <span class="variable">data</span> <span class="variable">starting</span> <span class="variable">from</span> <span class="variable">residue</span>
           <span class="variable">position</span> <span class="variable">one</span><span class="operator">.</span> <span class="variable">Since</span> <span class="variable">it</span> <span class="variable">is</span> <span class="variable">dependent</span> <span class="variable">on</span> <span class="variable">the</span> <span class="keyword">length</span> <span class="variable">of</span> <span class="variable">the</span>
           <span class="variable">sequence</span><span class="operator">,</span> <span class="variable">it</span> <span class="variable">needs</span> <span class="variable">to</span> <span class="variable">be</span> <span class="variable">manipulated</span> <span class="variable">after</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span>
 
           <span class="variable">The</span> <span class="keyword">length</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">returned</span> <span class="variable">value</span> <span class="variable">always</span> <span class="variable">matches</span> <span class="variable">the</span> <span class="keyword">length</span>
           <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span>
 
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">reference</span> <span class="variable">to</span> <span class="variable">an</span> <span class="variable">array</span> <span class="variable">of</span> <span class="variable">meta</span> <span class="variable">data</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">string</span> <span class="keyword">or</span> <span class="variable">array</span> <span class="keyword">ref</span> <span class="keyword">or</span> <span class="variable">Bio::Seq::PrimaryQual</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Setting quality values resets the clear range.</p>

<h2 id="qual_text">qual_text</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">qual_text</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$qual_values</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">qual_text</span><span class="operator">(</span><span class="variable">$values_arrayref</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Variant</span> <span class="variable">of</span> <span class="variable">meta</span><span class="operator">()</span> <span class="keyword">and</span> <span class="variable">qual</span><span class="operator">()</span>  <span class="variable">guarantied</span> <span class="variable">to</span> <span class="keyword">return</span> <span class="variable">a</span> <span class="variable">string</span>
           <span class="variable">representation</span>  <span class="variable">of</span> <span class="variable">meta</span> <span class="variable">data</span><span class="operator">.</span> <span class="variable">For</span> <span class="variable">details</span><span class="operator">,</span> <span class="variable">see</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">meta</span><span class="operator">&gt;.</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">a</span> <span class="variable">string</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="subqual">subqual</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">subqual</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$subset_of_qual_values</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">subqual</span><span class="operator">(</span><span class="number">10</span><span class="operator">,</span> <span class="number">20</span><span class="operator">,</span> <span class="variable">$value_string</span><span class="operator">);</span>
           <span class="variable">$subset_of_qual_values</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">subqual</span><span class="operator">(</span><span class="number">10</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">,</span> <span class="variable">$value_string</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span>
 
           <span class="variable">Get</span> <span class="keyword">and</span> <span class="variable">set</span> <span class="variable">method</span> <span class="keyword">for</span> <span class="variable">meta</span> <span class="variable">data</span> <span class="keyword">for</span> <span class="variable">subsequences</span><span class="operator">.</span>
 
           <span class="variable">Numbering</span> <span class="variable">starts</span> <span class="variable">from</span> <span class="number">1</span> <span class="keyword">and</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">is</span> <span class="variable">inclusive</span><span class="operator">,</span> <span class="variable">ie</span> <span class="number">1</span><span class="operator">-</span><span class="number">2</span>
           <span class="variable">are</span> <span class="variable">the</span> <span class="variable">first</span> <span class="variable">two</span> <span class="variable">residue</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span> <span class="variable">Start</span> <span class="variable">cannot</span> <span class="variable">be</span>
           <span class="variable">larger</span> <span class="variable">than</span> <span class="variable">end</span> <span class="variable">but</span> <span class="variable">can</span> <span class="variable">be</span> <span class="variable">equal</span><span class="operator">.</span>
 
           <span class="variable">If</span> <span class="variable">the</span> <span class="variable">second</span> <span class="variable">argument</span> <span class="variable">is</span> <span class="variable">missing</span> <span class="variable">the</span> <span class="variable">returned</span> <span class="keyword">values</span>
           <span class="variable">should</span> <span class="variable">extend</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">end</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span>
 
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">A</span> <span class="variable">reference</span> <span class="variable">to</span> <span class="variable">an</span> <span class="variable">array</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">integer</span><span class="operator">,</span> <span class="variable">start</span> <span class="variable">position</span>
           <span class="variable">integer</span><span class="operator">,</span> <span class="variable">end</span> <span class="variable">position</span><span class="operator">,</span> <span class="variable">optional</span> <span class="keyword">when</span> <span class="variable">a</span> <span class="variable">third</span> <span class="variable">argument</span> <span class="variable">present</span>
           <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="subqual_text">subqual_text</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">subqual_text</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$meta_values</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">subqual_text</span><span class="operator">(</span><span class="number">20</span><span class="operator">,</span> <span class="variable">$value_string</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Variant</span> <span class="variable">of</span> <span class="variable">subqual</span><span class="operator">()</span> <span class="variable">returning</span> <span class="variable">a</span> <span class="variable">stringified</span>
           <span class="variable">representation</span>  <span class="variable">of</span> <span class="variable">meta</span> <span class="variable">data</span><span class="operator">.</span> <span class="variable">For</span> <span class="variable">details</span><span class="operator">,</span> <span class="variable">see</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">Bio::Seq::MetaI</span><span class="operator">&gt;.</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">a</span> <span class="variable">string</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="quality_length">quality_length</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">quality_length</span><span class="operator">()</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$qual_len</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">quality_length</span><span class="operator">();</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="keyword">return</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">elements</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">quality</span> <span class="variable">array</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">integer</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="operator">-</span>
</code></code></pre>

<h2 id="quality_is_flush">quality_is_flush</h2>

<pre><code><code> Title   : quality_is_flush
 Usage   : $quality_is_flush  = $obj-&gt;quality_is_flush()
 Function: Boolean to tell if the trace length equals the sequence length.
           Returns true if force_flush() is set.
 Returns : boolean 1 or 0
 Args    : none</code></code></pre>

<h2 id="trace">trace</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">trace</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$trace_values</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">trace</span><span class="operator">(</span><span class="variable">$values_string</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span>
 
           <span class="variable">Get</span> <span class="keyword">and</span> <span class="variable">set</span> <span class="variable">method</span> <span class="keyword">for</span> <span class="variable">the</span> <span class="variable">meta</span> <span class="variable">data</span> <span class="variable">starting</span> <span class="variable">from</span> <span class="variable">residue</span>
           <span class="variable">position</span> <span class="variable">one</span><span class="operator">.</span> <span class="variable">Since</span> <span class="variable">it</span> <span class="variable">is</span> <span class="variable">dependent</span> <span class="variable">on</span> <span class="variable">the</span> <span class="keyword">length</span> <span class="variable">of</span> <span class="variable">the</span>
           <span class="variable">sequence</span><span class="operator">,</span> <span class="variable">it</span> <span class="variable">needs</span> <span class="variable">to</span> <span class="variable">be</span> <span class="variable">manipulated</span> <span class="variable">after</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span>
 
           <span class="variable">The</span> <span class="keyword">length</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">returned</span> <span class="variable">value</span> <span class="variable">always</span> <span class="variable">matches</span> <span class="variable">the</span> <span class="keyword">length</span>
           <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span>
 
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">reference</span> <span class="variable">to</span> <span class="variable">an</span> <span class="variable">array</span> <span class="variable">of</span> <span class="variable">meta</span> <span class="variable">data</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">string</span> <span class="keyword">or</span> <span class="variable">array</span> <span class="keyword">ref</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="trace_text">trace_text</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">trace_text</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$trace_values</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">trace_text</span><span class="operator">(</span><span class="variable">$values_arrayref</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Variant</span> <span class="variable">of</span> <span class="variable">meta</span><span class="operator">()</span> <span class="keyword">and</span> <span class="variable">trace</span><span class="operator">()</span>  <span class="variable">guarantied</span> <span class="variable">to</span> <span class="keyword">return</span> <span class="variable">a</span> <span class="variable">string</span>
           <span class="variable">representation</span>  <span class="variable">of</span> <span class="variable">meta</span> <span class="variable">data</span><span class="operator">.</span> <span class="variable">For</span> <span class="variable">details</span><span class="operator">,</span> <span class="variable">see</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">meta</span><span class="operator">&gt;.</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">a</span> <span class="variable">string</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="subtrace">subtrace</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">subtrace</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$subset_of_trace_values</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">subtrace</span><span class="operator">(</span><span class="number">10</span><span class="operator">,</span> <span class="number">20</span><span class="operator">,</span> <span class="variable">$value_string</span><span class="operator">);</span>
           <span class="variable">$subset_of_trace_values</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">subtrace</span><span class="operator">(</span><span class="number">10</span><span class="operator">,</span> <span class="keyword">undef</span><span class="operator">,</span> <span class="variable">$value_string</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span>
 
           <span class="variable">Get</span> <span class="keyword">and</span> <span class="variable">set</span> <span class="variable">method</span> <span class="keyword">for</span> <span class="variable">meta</span> <span class="variable">data</span> <span class="keyword">for</span> <span class="variable">subsequences</span><span class="operator">.</span>
 
           <span class="variable">Numbering</span> <span class="variable">starts</span> <span class="variable">from</span> <span class="number">1</span> <span class="keyword">and</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">is</span> <span class="variable">inclusive</span><span class="operator">,</span> <span class="variable">ie</span> <span class="number">1</span><span class="operator">-</span><span class="number">2</span>
           <span class="variable">are</span> <span class="variable">the</span> <span class="variable">first</span> <span class="variable">two</span> <span class="variable">residue</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span> <span class="variable">Start</span> <span class="variable">cannot</span> <span class="variable">be</span>
           <span class="variable">larger</span> <span class="variable">than</span> <span class="variable">end</span> <span class="variable">but</span> <span class="variable">can</span> <span class="variable">be</span> <span class="variable">equal</span><span class="operator">.</span>
 
           <span class="variable">If</span> <span class="variable">the</span> <span class="variable">second</span> <span class="variable">argument</span> <span class="variable">is</span> <span class="variable">missing</span> <span class="variable">the</span> <span class="variable">returned</span> <span class="keyword">values</span>
           <span class="variable">should</span> <span class="variable">extend</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">end</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">sequence</span><span class="operator">.</span>
 
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">A</span> <span class="variable">reference</span> <span class="variable">to</span> <span class="variable">an</span> <span class="variable">array</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">integer</span><span class="operator">,</span> <span class="variable">start</span> <span class="variable">position</span>
           <span class="variable">integer</span><span class="operator">,</span> <span class="variable">end</span> <span class="variable">position</span><span class="operator">,</span> <span class="variable">optional</span> <span class="keyword">when</span> <span class="variable">a</span> <span class="variable">third</span> <span class="variable">argument</span> <span class="variable">present</span>
           <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="subtrace_text">subtrace_text</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">subtrace_text</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$meta_values</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">subtrace_text</span><span class="operator">(</span><span class="number">20</span><span class="operator">,</span> <span class="variable">$value_string</span><span class="operator">);</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Variant</span> <span class="variable">of</span> <span class="variable">subtrace</span><span class="operator">()</span> <span class="variable">returning</span> <span class="variable">a</span> <span class="variable">stringified</span>
           <span class="variable">representation</span>  <span class="variable">of</span> <span class="variable">meta</span> <span class="variable">data</span><span class="operator">.</span> <span class="variable">For</span> <span class="variable">details</span><span class="operator">,</span> <span class="variable">see</span> <span class="variable">L</span><span class="operator">&lt;</span><span class="variable">Bio::Seq::MetaI</span><span class="operator">&gt;.</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">a</span> <span class="variable">string</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<h2 id="trace_length">trace_length</h2>

<pre><code><code> <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">trace_length</span><span class="operator">()</span>
 <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$trace_len</span>  <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">trace_length</span><span class="operator">();</span>
 <span class="variable">Function</span><span class="operator">:</span> <span class="keyword">return</span> <span class="variable">the</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">elements</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">trace</span> <span class="variable">set</span>
 <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">integer</span>
 <span class="variable">Args</span>    <span class="operator">:</span> <span class="operator">-</span>
</code></code></pre>

<h2 id="trace_is_flush">trace_is_flush</h2>

<pre><code><code> Title   : trace_is_flush
 Usage   : $trace_is_flush  = $obj-&gt;trace_is_flush()
 Function: Boolean to tell if the trace length equals the sequence length.
           Returns true if force_flush() is set.
 Returns : boolean 1 or 0
 Args    : none</code></code></pre>

<h2 id="get_trace_graph">get_trace_graph</h2>

<pre><code><code> Title    : get_trace_graph
 Usage    : @trace_values = $obj-&gt;get_trace_graph( -trace =&gt; &#39;a&#39;,
                                                   -scale =&gt; 100)
 Function : Returns array of raw trace values for a trace file, or
            false if no trace data exists.  Requires a value for trace
            to get either the a, g, c or t trace information, and an
            optional value for scale, which rescales the data between
            0 and the provided value, a scale value of &#39;0&#39; performs no
            scaling
 Returns  : Array or 0
 Args     : string, trace to retrieve, one of a, g, c or t integer,
            scale, for scaling of trace between 0 and scale, or 0 for
            no scaling, optional</code></code></pre>

<h2 id="threshold">threshold</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">threshold</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$qual</span><span class="operator">-&gt;</span><span class="variable">threshold</span><span class="operator">(</span><span class="variable">$value</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Sets</span> <span class="variable">the</span> <span class="variable">quality</span> <span class="variable">threshold</span><span class="operator">.</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">an</span> <span class="variable">integer</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">new</span> <span class="variable">value</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Value used by *clear_range* method below.</p>

<h2 id="mask_below_threshold">mask_below_threshold</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">mask_below_threshold</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">count_clear_ranges</span><span class="operator">(</span><span class="variable">$threshold</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Counts</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">ranges</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">sequence</span> <span class="variable">where</span> <span class="variable">quality</span>
            <span class="keyword">values</span> <span class="variable">are</span> <span class="variable">above</span> <span class="variable">the</span> <span class="variable">threshold</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">count</span> <span class="variable">integer</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">threshold</span> <span class="variable">integer</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Set threshold first using method <a>threshold</a>.</p>

<h2 id="count_clear_ranges">count_clear_ranges</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">count_clear_ranges</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$count</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">count_clear_ranges</span><span class="operator">(</span><span class="variable">$threshold</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Counts</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">ranges</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">sequence</span> <span class="variable">where</span> <span class="variable">quality</span>
            <span class="keyword">values</span> <span class="variable">are</span> <span class="variable">above</span> <span class="variable">the</span> <span class="variable">threshold</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">count</span> <span class="variable">integer</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">threshold</span> <span class="variable">integer</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Set threshold first using method <a>threshold</a>.</p>

<h2 id="clear_ranges_length">clear_ranges_length</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">clear_ranges_length</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$total_lenght</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">clear_ranges_length</span><span class="operator">(</span><span class="variable">$threshold</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Return</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">residues</span> <span class="variable">with</span> <span class="variable">quality</span> <span class="keyword">values</span> <span class="variable">above</span>
            <span class="variable">the</span> <span class="variable">threshold</span> <span class="variable">in</span> <span class="variable">all</span> <span class="variable">clear</span> <span class="variable">ranges</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">an</span> <span class="variable">integer</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">threshold</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Set threshold first using method <a>threshold</a>.</p>

<p>I think this method needs a better name! count_high_quality_bases? or sum_clear_ranges?</p>

<h2 id="get_clear_range">get_clear_range</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">get_clear_range</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">$newqualobj</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">get_clear_range</span><span class="operator">(</span><span class="variable">$threshold</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Return</span> <span class="variable">longest</span> <span class="variable">subsequence</span> <span class="variable">that</span> <span class="variable">has</span> <span class="variable">quality</span> <span class="keyword">values</span> <span class="variable">above</span>
            <span class="variable">the</span> <span class="keyword">given</span> <span class="variable">threshold</span><span class="operator">,</span> <span class="keyword">or</span> <span class="variable">a</span> <span class="keyword">default</span> <span class="variable">value</span> <span class="variable">of</span> <span class="number">13</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">a</span> <span class="variable">new</span> <span class="variable">Bio::Seq::Quality</span> <span class="variable">object</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">threshold</span><span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Set threshold first using method <a>threshold</a>.</p>

<p>Note, this method could be implemented using some gaussian smoothing of the quality scores. Currently one base below the threshold is enough to end the clear range.</p>

<h2 id="get_all_clean_ranges">get_all_clean_ranges</h2>

<pre><code><code>  <span class="variable">Title</span>   <span class="operator">:</span> <span class="variable">get_all_clean_ranges</span>
  <span class="variable">Usage</span>   <span class="operator">:</span> <span class="variable">@ranges</span> <span class="operator">=</span> <span class="variable">$obj</span><span class="operator">-&gt;</span><span class="variable">get_all_clean_ranges</span><span class="operator">(</span><span class="variable">$minlength</span><span class="operator">);</span>
  <span class="variable">Function</span><span class="operator">:</span> <span class="variable">Return</span> <span class="variable">all</span> <span class="variable">ranges</span> <span class="variable">where</span> <span class="variable">quality</span> <span class="keyword">values</span> <span class="variable">are</span> <span class="variable">above</span>
            <span class="variable">the</span> <span class="variable">threshold</span><span class="operator">.</span> <span class="variable">Original</span> <span class="variable">ordering</span><span class="operator">.</span>
  <span class="variable">Returns</span> <span class="operator">:</span> <span class="variable">an</span> <span class="variable">ordered</span> <span class="variable">array</span> <span class="variable">of</span> <span class="variable">new</span> <span class="variable">Bio::Seq::Quality</span> <span class="variable">objects</span>
  <span class="variable">Args</span>    <span class="operator">:</span> <span class="variable">minimum</span> <span class="keyword">length</span> <span class="operator">,</span> <span class="variable">optional</span>
</code></code></pre>

<p>Set threshold first using method <a>threshold</a>.</p>


</body>

</html>


