<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../displayToc.js"></script>
<script language="JavaScript" src="../../../tocParas.js"></script>
<script language="JavaScript" src="../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#BUGS">BUGS</a></li>
  <li><a href="#AUTHOR-AND-COPYRIGHT">AUTHOR AND COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Math::Fleximal - Integers with flexible representations.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Math::Fleximal</span><span class="operator">;</span>
  <span class="keyword">my</span> <span class="variable">$number</span> <span class="operator">=</span> <span class="variable">new</span> <span class="variable">Math::Fleximal</span><span class="operator">(</span><span class="variable">$value</span><span class="operator">,</span> <span class="variable">$flex</span><span class="operator">);</span>
  
  <span class="comment"># Set the value</span>
  <span class="variable">$number</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">set_value</span><span class="operator">(</span><span class="string">"- </span><span class="variable">$fleck_4$fleck_3</span><span class="string">"</span><span class="operator">);</span>
  <span class="variable">$number</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">set_value</span><span class="operator">(</span><span class="variable">$another_number</span><span class="operator">);</span>
  
  <span class="comment"># Get the object in a familiar form  </span>
  <span class="keyword">my</span> <span class="variable">$string</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">to_str</span><span class="operator">();</span>
  <span class="keyword">my</span> <span class="variable">$integer</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">base_10</span><span class="operator">();</span>
  
  <span class="comment"># Construct more numbers with same flex</span>
  <span class="keyword">my</span> <span class="variable">$copy</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">dup</span><span class="operator">();</span>
  <span class="keyword">my</span> <span class="variable">$other_number</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">dup</span><span class="operator">(</span><span class="variable">$value</span><span class="operator">);</span>
  <span class="keyword">my</span> <span class="variable">$absolute_value</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">abs</span><span class="operator">();</span>
  
  <span class="comment"># New representation anyone?</span>
  <span class="keyword">my</span> <span class="variable">$in_new_base</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">change_flex</span><span class="operator">(</span><span class="variable">$new_flex</span><span class="operator">);</span>
  
  <span class="comment"># Arithmetic - can be different flex.  Answers have</span>
  <span class="comment"># the flex of $number.</span>
  <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">add</span><span class="operator">(</span><span class="variable">$other_number</span><span class="operator">);</span>
  <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">mul</span><span class="operator">(</span><span class="variable">$other_number</span><span class="operator">);</span>
  <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">subtr</span><span class="operator">(</span><span class="variable">$other_numer</span><span class="operator">);</span>
  <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">div</span><span class="operator">(</span><span class="variable">$other_number</span><span class="operator">);</span>
  
  <span class="comment"># And integer-specific arithmetic works</span>
  <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">gcd</span><span class="operator">(</span><span class="variable">$other_number</span><span class="operator">);</span>
  <span class="variable">$result</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">mod</span><span class="operator">(</span><span class="variable">$other_number</span><span class="operator">);</span>
  
  <span class="keyword">my</span> <span class="variable">$comparison</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">cmp</span><span class="operator">(</span><span class="variable">$other_number</span><span class="operator">);</span>
</code></code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This is a package for doing integer arithmetic while using a different base representation than normal. In base n arithmetic you have n symbols which have a representation. I was going to call them &quot;glyphs&quot;, but being text strings they are not really. On Tye McQueen&#39;s whimsical suggestion I settled on the name Math::Fleximal, the set of text representations is called a &quot;flex&quot;, and the representation of individual digits are the &quot;flecks&quot;. These names are somewhat unofficial...</p>

<p>This allows you to do basic arithmetic using whatever digits you want, and to convert from one to another.</p>

<p>Like <code><code>Math::BigInt</code></code> it is able to handle very large numbers, though performance is not very good. (Which is also like <code><code>Math::BigInt</code></code>, for good performance you should be using &lt;Bit::Vector&gt;.) Instead use it as a version of Math::BaseCalc without an upper limit on the size of numbers. A sample use would be to put an MD5 hash into a convenient representation:</p>

<pre><code><code>  <span class="keyword">use</span> <span class="variable">Math::Fleximal</span><span class="operator">;</span>
  <span class="keyword">use</span> <span class="variable">Digest::MD5</span> <span class="string">qw(md5_hex)</span><span class="operator">;</span>
  <span class="keyword">my</span> <span class="variable">$digest</span> <span class="operator">=</span> <span class="variable">hex2alpha</span><span class="operator">(</span><span class="variable">md5_hex</span><span class="operator">(</span><span class="variable">$data</span><span class="operator">));</span>
  
  <span class="comment"># Converts a hex representation of a number into</span>
  <span class="comment"># one that uses more alphanumerics.  (ie base 62)</span>
  <span class="keyword">sub</span><span class="variable"> hex2alpha </span><span class="operator">{</span>
    <span class="variable">Math::Fleximal</span><span class="operator">-&gt;</span><span class="variable">new</span><span class="operator">(</span>
      <span class="keyword">lc</span><span class="operator">(</span><span class="keyword">shift</span><span class="operator">),</span> <span class="operator">[</span><span class="number">0</span><span class="operator">..</span><span class="number">9</span><span class="operator">,</span> <span class="string">'a'</span><span class="operator">..</span><span class="string">'f'</span><span class="operator">]</span>
    <span class="operator">)-&gt;</span><span class="variable">change_flex</span><span class="operator">(</span>
      <span class="operator">[</span><span class="number">0</span><span class="operator">..</span><span class="number">9</span><span class="operator">,</span><span class="string">'a'</span><span class="operator">..</span><span class="string">'z'</span><span class="operator">,</span><span class="string">'A'</span><span class="operator">..</span><span class="string">'Z'</span><span class="operator">]</span>
    <span class="operator">)-&gt;</span><span class="variable">to_str</span><span class="operator">();</span>
  <span class="operator">}</span>
</code></code></pre>

<dl>

<dt id="new"><code><code>new</code></code></dt>
<dd>

<p>Construct a new number. The arguments are the value, the anonymous array of flecks that make up the flex, followed by an anonymous hash of other arguments. The flex will default to [0..9] and the other arguments will default to an empty hash.</p>

<p>This can be used to calculations in bases other than 10 - the base is just the number of flecks in the flex. So you could construct a base 16 number with:</p>

<pre><code><code>  <span class="keyword">my</span> <span class="variable">$base_16</span> <span class="operator">=</span> <span class="variable">new</span> <span class="variable">Math::Fleximal</span><span class="operator">(</span><span class="string">"4d"</span><span class="operator">,</span> <span class="operator">[</span><span class="number">0</span><span class="operator">..</span><span class="number">9</span><span class="operator">,</span> <span class="string">'a'</span><span class="operator">..</span><span class="string">'f'</span><span class="operator">]</span><span class="operator">);</span>
</code></code></pre>

<p>If a value is passed it can be an existing Math::Fleximal or (as above) a string that can be parsed with the current flex.</p>

<p>The possible keys to the optional arguments are:</p>

<ul>

<li><p><i>+</i> for the plus symbol to use. This defaults to &#39;+&#39;.</p>

</li>
<li><p><i>-</i> for the minus symbol to use. This defaults to &#39;-&#39;.</p>

</li>
<li><p><i>show_+</i> is a flag for whether to show the plus symbol on positive numbers. This defaults to a false value.</p>

</li>
<li><p>Whatever matches <i>strip</i> will be stripped from the string before parsing. This defaults to qr/[\s\.,_]/ to cover most of the common ways that are used to group digits in a long number.</p>

</li>
</ul>

<p>The parsing of a string into flecks is case sensitive. Also possibly ambiguous parses are not handled very well.</p>

</dd>
<dt id="dup"><code><code>dup</code></code></dt>
<dd>

<p>Copy an existing number. This copy may be worked with without changing the existing number. If dup is passed a value, the new instance will have that value instead.</p>

</dd>
<dt id="set_value"><code><code>set_value</code></code></dt>
<dd>

<p>This sets the internal value and returns the object.</p>

<p>You can either pass the new value an existing instance (which may be in another base) or a string. When passed a string it first strips whitespace. After that it accepts an optional +-, followed by a series of flecks (there must be at least one) for the first to last digits. It will be confused if the leading fleck starts with + or - and no sign is included.</p>

</dd>
<dt id="to_str"><code><code>to_str</code></code></dt>
<dd>

<p>Returns the string representation of the current value using the current flex. This always includes a sign, with no white space in front of the sign.</p>

</dd>
<dt id="base_10"><code><code>base_10</code></code></dt>
<dd>

<p>Returns the internal value in a base 10 representation. The numbers returned may be larger than Perl&#39;s usual integer representation can handle.</p>

</dd>
<dt id="change_flex"><code><code>change_flex</code></code></dt>
<dd>

<p>Takes a new flex and converts the current to that. Will implicitly change base if needed.</p>

</dd>
<dt id="add"><code><code>add</code></code></dt>
<dd>

<p>Adds one or more numbers to the current one and returns the answer in the current representation. The numbers may be objects in any base, or strings of the current representation.</p>

</dd>
<dt id="mul"><code><code>mul</code></code></dt>
<dd>

<p>Multiplies one or more numbers to the current one and returns the answer in the current representation. The numbers may be objects in any base, or strings of the current representation.</p>

</dd>
<dt id="subtr"><code><code>subtr</code></code></dt>
<dd>

<p>Subtracts one or more numbers from the current one and returns the answer in the current representation. The numbers may be objects in any base, or strings of the current representation.</p>

</dd>
<dt id="div"><code><code>div</code></code></dt>
<dd>

<p>Divides one or more numbers from the current one and returns the answer in the current representation. In list context it will return the answer and an array of remainders in the current representation. The remainders will be positive and less than the absolute value of the denominator. The numbers may be objects in any base, or strings of the current representation.</p>

</dd>
<dt id="gcd"><code><code>gcd</code></code></dt>
<dd>

<p>Takes one or more numbers and calculates the gcd of this and the entire list.</p>

</dd>
<dt id="mod"><code><code>mod</code></code></dt>
<dd>

<p>Does the divisions as <code><code>div</code></code> does and returns only the remainders. In scalar context only the last remainder is returned. Thus the following returns the ten-thousands digit:</p>

<pre><code><code>  <span class="keyword">my</span> <span class="variable">$digit</span> <span class="operator">=</span> <span class="variable">$number</span><span class="operator">-&gt;</span><span class="variable">mod</span><span class="operator">(</span><span class="number">1000</span><span class="operator">,</span> <span class="number">10</span><span class="operator">);</span>
</code></code></pre>

</dd>
<dt id="cmp"><code><code>cmp</code></code></dt>
<dd>

<p>Pass another number, returns -1 if it is smaller than the other number, 0 if they are equal, and 1 if it is larger. (Much like cmp does with strings.)</p>

</dd>
<dt id="one"><code><code>one</code></code></dt>
<dd>

<p>Returns 1 in the current flex.</p>

</dd>
<dt id="zero"><code><code>zero</code></code></dt>
<dd>

<p>Returns 0 in the current flex.</p>

</dd>
</dl>

<h1 id="BUGS">BUGS</h1>

<p>This will fail if you are trying to work in bases of size more than 30,000 or so.</p>

<p>Only a slight effort is made to resolve potential ambiguities in the parsing of a string into flecks.</p>

<h1 id="AUTHOR-AND-COPYRIGHT">AUTHOR AND COPYRIGHT</h1>

<p>Copyright 2000-2001, Ben Tilly (&lt;btilly@gmail.com&gt;)</p>

<p>Math::Fleximal may be copied and distributed on the same terms as Perl itself.</p>


</body>

</html>


